{"version":3,"sources":["webpack:///./src/views/BookPage/BookTitle.tsx","webpack:///./src/views/BookPage/BookImage.tsx","webpack:///./src/views/BookPage/BookReview.tsx","webpack:///./src/views/BookPage/BookMeta.tsx","webpack:///./src/components/RelatedBooks/index.tsx","webpack:///./src/views/BookPage/index.tsx","webpack:///./src/utils/urls/affiliates.ts","webpack:///./src/views/BookPage/BookAffiliates.tsx","webpack:///./node_modules/core-js/modules/es6.array.find.js","webpack:///./node_modules/core-js/modules/es7.object.values.js","webpack:///./src/components/cards/VideoCard/index.tsx"],"names":["StyledTitle","styled","H","StyledAuthor","BookTitle","title","author","rating7","as","size","decorative","StarRating","of7","StyledBookImage","figure","BORDER_RADIUS","S","screenMax","m","screen","l","toVW","MARGIN_COLUMNS","L","COLUMN_WIDTH","GAP","xl","XL","StyledImg","Img","BookImage","image","style","background","colors","muted","key","childImageSharp","fluid","src","darkMuted","StyledBookReview","div","BookReview","summary","html","fontSize","dangerouslySetInnerHTML","__html","StyledDt","dt","FONT","SIZE","WEIGHT","BOLD","StyledDd","dd","StyledOl","ol","BookMeta","pageCount","dateBookPublished","tags","readDates","dateRated","dateReviewed","shortFormatDate","length","map","tag","StyledWrapper","StyledGrid","Grid","RelatedBooks","books","full","book","featured","GridItem","id","span","spanFromM","spanFromL","BookCard","StyledMeta","aside","screenMin","StyledBookTitle","query","BookPage","data","bookData","timestampMentionData","featuredVideoData","location","normalizeItem","timestampMentions","normalizeArray","featuredVideos","relatedBooks","Layout","rows","rowsFromM","columnsFromM","columnsFromL","columnsFromXL","spanRowsFromM","Math","ceil","BookAffiliates","links","video","spanFromXL","VideoCard","mention","timestamp","formatTimestamp","timestamps","find","t","AFFILIATES","GOODREADS","AMAZON","BOOK_DEPOSITORY","AFFILIATE_ACTIONS","StyledLi","li","Object","entries","affiliateAbbr","label","href","long","$export","$find","forced","Array","P","F","callbackfn","this","arguments","undefined","$values","values","it","StyledVideoCard","Link","COLOR","BACKGROUND_DARK","StyledDetails","StyledTimestamp","p","XS","StyledDatePublished","time","StyledH","StyledBookContentsWrapper","isStars","featuredBookCount","filter","to","slug","lightVibrant","color","vibrant","ownedBy","frontmatter","datePublished","formatViewCount","viewCount"],"mappings":"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","file":"component---src-views-book-page-index-tsx-f4585b20481438c67025.js","sourcesContent":["import React from 'react'\nimport styled from 'styled-components'\n\nimport { Book } from 'types/book'\nimport StarRating from 'components/StarRating'\nimport H from 'components/H'\n\nconst StyledTitle = styled(H)`\n  margin: 0;\n`\n\nconst StyledAuthor = styled(H)`\n  margin: 0.5em 0 1em;\n`\n\ntype Props = Pick<Book, 'title' | 'author' | 'rating7'>\n\nconst BookTitle: React.FC<Props> = ({ title, author, rating7 }) => (\n  <>\n    <StyledTitle as=\"h2\" size=\"XXL\" decorative>\n      {title}\n    </StyledTitle>\n    <StyledAuthor as=\"h2\" size=\"M\">\n      by {author}\n    </StyledAuthor>\n\n    {rating7 && <StarRating of7={rating7} />}\n  </>\n)\n\nexport default BookTitle\n","import React from 'react'\nimport styled from 'styled-components'\nimport Img from 'gatsby-image'\n\nimport { Book } from 'types/book'\nimport { BORDER_RADIUS } from 'styles/tokens'\nimport { screen, screenMax } from 'styles/responsive'\nimport { toVW, MARGIN_COLUMNS, COLUMN_WIDTH, GAP } from 'styles/layout'\n\nconst StyledBookImage = styled.figure`\n  position: relative;\n  margin: 0;\n  box-sizing: border-box;\n  padding: 2em 0;\n  width: 100%;\n  max-height: 500px;\n  border-radius: ${BORDER_RADIUS.S};\n\n  ${screenMax.m`\n    text-align: center;\n  `}\n\n  ${screen.l`\n    padding-left: ${toVW(MARGIN_COLUMNS.L * (COLUMN_WIDTH.L + GAP.L))};\n  `}\n  ${screen.xl`\n    padding-left: ${toVW(MARGIN_COLUMNS.XL * (COLUMN_WIDTH.XL + GAP.XL))};\n  `}\n`\n\nconst StyledImg = styled(Img)`\n  display: inline-block;\n  width: 250px;\n  box-shadow: 0 0.4em 1em rgba(0, 0, 0, 0.2), 0 0 0.6em rgba(0, 0, 0, 0.1);\n`\n\ntype Props = Pick<Book, 'image'>\n\nconst BookImage: React.FC<Props> = ({ image }) => (\n  <StyledBookImage style={{ background: image.colors.muted }}>\n    <StyledImg\n      key={image.childImageSharp.fluid.src}\n      fluid={image.childImageSharp.fluid}\n      style={{ background: image.colors.darkMuted }}\n    />\n  </StyledBookImage>\n)\n\nexport default BookImage\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport { Book } from 'types/book'\n\nconst StyledBookReview = styled.div`\n  margin-top: 1em;\n`\n\ntype Props = Pick<Book, 'summary' | 'html'>\n\nconst BookReview: React.FC<Props> = ({ summary, html }) => (\n  <StyledBookReview>\n    {summary && (\n      <details style={{ fontSize: '0.75em' }}>\n        <summary>Book sumary</summary>\n        {summary}\n      </details>\n    )}\n\n    {html && <div dangerouslySetInnerHTML={{ __html: html }} />}\n  </StyledBookReview>\n)\n\nexport default BookReview\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport { Book } from 'types/book'\nimport { shortFormatDate } from 'utils/formatting/time'\nimport { FONT } from 'styles/tokens'\n\nconst StyledDt = styled.dt`\n  font-size: ${FONT.SIZE.S};\n  font-weight: ${FONT.WEIGHT.BOLD};\n`\n\nconst StyledDd = styled.dd`\n  font-size: ${FONT.SIZE.S};\n  margin: 0 0 1em;\n`\n\nconst StyledOl = styled.ol`\n  margin: 0;\n  list-style: disc;\n`\n\ntype Props = Pick<\n  Book,\n  | 'pageCount'\n  | 'dateBookPublished'\n  | 'tags'\n  | 'readDates'\n  | 'dateRated'\n  | 'dateReviewed'\n>\n\nconst BookMeta: React.FC<Props> = ({\n  pageCount,\n  dateBookPublished,\n  tags,\n  readDates,\n  dateRated,\n  dateReviewed,\n}) => (\n  <div>\n    <dl>\n      <StyledDt>Page count</StyledDt>\n      <StyledDd>{pageCount}</StyledDd>\n      <StyledDt>Date published</StyledDt>\n      <StyledDd>{shortFormatDate(dateBookPublished)}</StyledDd>\n\n      {tags && tags.length === 0 ? null : (\n        <>\n          <StyledDt>Tags</StyledDt>\n          <StyledDd>\n            <StyledOl>\n              {tags.map((tag) => (\n                <li key={tag}>{tag}</li>\n              ))}\n            </StyledOl>\n          </StyledDd>\n        </>\n      )}\n    </dl>\n\n    <dl>\n      <StyledDt>Date read</StyledDt>\n      <StyledDd>{shortFormatDate(readDates[readDates.length - 1][1])}</StyledDd>\n      <StyledDt>Date rated</StyledDt>\n      <StyledDd>{shortFormatDate(dateRated)}</StyledDd>\n      {dateReviewed && (\n        <>\n          <StyledDt>Date reviewed</StyledDt>\n          <StyledDd>{shortFormatDate(dateReviewed)}</StyledDd>\n        </>\n      )}\n    </dl>\n  </div>\n)\n\nexport default BookMeta\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport Grid from 'components/Grid'\nimport GridItem from 'components/Grid/GridItem'\nimport { FONT } from 'styles/tokens'\nimport { screen } from 'styles/responsive'\n\nimport { BookCardType } from 'types/book/card'\nimport BookCard from 'components/cards/BookCard'\n\nconst StyledWrapper = styled.div`\n  margin: 1.5em 0;\n`\n\nconst StyledGrid = styled(Grid)`\n  font-size: ${FONT.SIZE.S};\n\n  ${screen.l`\n    > *:nth-last-child(1) {\n      display: none;\n    }\n  `}\n`\n\ninterface Props {\n  books: BookCardType[]\n}\n\nconst RelatedBooks: React.FC<Props> = ({ books }) => (\n  <StyledWrapper>\n    <StyledGrid full>\n      {books.map(\n        (book: BookCardType): React.ReactNode => {\n          const featured = book.rating7 >= 6\n          return (\n            <GridItem key={book.id} span={1} spanFromM={3} spanFromL={2}>\n              <BookCard book={book} featured={featured} />\n            </GridItem>\n          )\n        }\n      )}\n    </StyledGrid>\n  </StyledWrapper>\n)\n\nexport default RelatedBooks\n","import React from 'react'\nimport styled from 'styled-components'\nimport { graphql } from 'gatsby'\n\nimport { PageProps } from 'types/page'\nimport { RawBook, Book } from 'types/book'\nimport { RawVideoSnapshot, VideoSnapshot } from 'types/video/snapshot'\nimport { normalizeItem, normalizeArray } from 'utils/graphql/normalize'\nimport Layout from 'Layout'\nimport Grid from 'components/Grid'\nimport GridItem from 'components/Grid/GridItem'\nimport VideoCard from 'components/cards/VideoCard'\nimport { screen, screenMin } from 'styles/responsive'\nimport { GAP, toVW } from 'styles/layout'\nimport { formatTimestamp } from 'utils/formatting/time'\n\nimport BookTitle from './BookTitle'\nimport BookImage from './BookImage'\nimport BookReview from './BookReview'\nimport BookMeta from './BookMeta'\nimport BookAffiliates from './BookAffiliates'\nimport { VideoCardType } from 'types/video/card'\nimport { BookCardType, RawBookCard } from 'types/book/card'\nimport RelatedBooks from 'components/RelatedBooks'\n\nconst StyledMeta = styled.aside`\n  ${screenMin.l`\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    grid-gap: ${toVW(GAP.L)};\n  `}\n\n  ${screen.xl`\n    grid-gap: ${toVW(GAP.XL)};\n  `}\n`\n\nconst StyledBookTitle = styled.div`\n  align-self: end;\n`\n\ninterface Props extends PageProps {\n  data: {\n    bookData: RawBook\n    timestampMentionData: {\n      edges: {\n        node: RawVideoSnapshot\n      }[]\n    }\n    featuredVideoData: {\n      edges: {\n        node: RawVideoSnapshot\n      }[]\n    }\n    relatedbooksData: {\n      edges: {\n        node: RawBookCard\n      }[]\n    }\n  }\n}\n\nconst BookPage: React.FC<Props> = ({\n  data: { bookData, timestampMentionData, featuredVideoData },\n  location,\n}) => {\n  const book = normalizeItem(bookData) as Book\n  const timestampMentions = normalizeArray(\n    timestampMentionData\n  ) as VideoSnapshot[]\n  const featuredVideos = normalizeArray(featuredVideoData) as VideoSnapshot[]\n  const relatedBooks = book.relatedBooks.map(normalizeItem) as BookCardType[]\n\n  return (\n    <Layout location={location}>\n      <Grid full>\n        <GridItem\n          as={StyledBookTitle}\n          rows=\"2/3\"\n          rowsFromM=\"1/2\"\n          columnsFromM=\"7 / 12\"\n          columnsFromL=\"8 / 14\"\n          columnsFromXL=\"9 / 15\"\n        >\n          <BookTitle\n            title={book.title}\n            author={book.author}\n            rating7={book.rating7}\n          />\n        </GridItem>\n\n        <GridItem columnsFromM=\"1/7\" columnsFromL=\"1/8\" columnsFromXL=\"1/9\">\n          <BookImage image={book.image} />\n        </GridItem>\n\n        <GridItem\n          as={StyledMeta}\n          spanFromM={4}\n          columnsFromL=\"2/8\"\n          columnsFromXL=\"3/9\"\n          spanRowsFromM={\n            2 +\n            Math.ceil((timestampMentions.length + featuredVideos.length) / 2)\n          }\n        >\n          <BookMeta\n            pageCount={book.pageCount}\n            dateBookPublished={book.dateBookPublished}\n            tags={book.tags}\n            readDates={book.readDates}\n            dateRated={book.dateRated}\n            dateReviewed={book.dateReviewed}\n          />\n\n          <BookAffiliates links={book.links} />\n        </GridItem>\n\n        <GridItem columnsFromM=\"5/13\" columnsFromL=\"8/15\" columnsFromXL=\"9/15\">\n          <BookReview summary={book.summary} html={book.html} />\n        </GridItem>\n\n        {featuredVideos.map((video) => (\n          <GridItem\n            key={video.id}\n            span={1}\n            spanFromM={4}\n            spanFromL={3}\n            spanFromXL={4}\n          >\n            <VideoCard video={video as VideoCardType} />\n          </GridItem>\n        ))}\n\n        {timestampMentions.map((mention) => {\n          const timestamp = formatTimestamp(\n            mention.timestamps.find((t) => t.book && t.book.id === book.id).t\n          )\n\n          return (\n            <GridItem\n              key={mention.id}\n              span={1}\n              spanFromM={4}\n              spanFromL={3}\n              spanFromXL={4}\n            >\n              <VideoCard\n                video={mention as VideoCardType}\n                timestamp={timestamp}\n              />\n            </GridItem>\n          )\n        })}\n      </Grid>\n\n      <RelatedBooks books={relatedBooks} />\n    </Layout>\n  )\n}\n\nexport const query = graphql`\n  query BookPage($id: String!) {\n    bookData: markdownRemark(id: { eq: $id }) {\n      ...BookFields\n    }\n    timestampMentionData: allVideos(\n      filter: { timestamps: { elemMatch: { book: { id: { eq: $id } } } } }\n    ) {\n      edges {\n        node {\n          ...VideoSnapshotFields\n        }\n      }\n    }\n    featuredVideoData: allVideos(\n      filter: { ownedBy: { id: { eq: $id } } }\n      sort: { fields: datePublished, order: DESC }\n    ) {\n      edges {\n        node {\n          ...VideoSnapshotFields\n        }\n      }\n    }\n  }\n`\n\nexport default BookPage\n","import { makeIsbn10 } from 'utils/formatting/isbn'\n\nexport const AFFILIATES = {\n  GOODREADS: 'gr',\n  AMAZON: 'amzn',\n  BOOK_DEPOSITORY: 'bd',\n}\n\nexport const getLink = (isbn: number, affiliateAbbr: string): string => {\n  if (affiliateAbbr === AFFILIATES.GOODREADS)\n    return `https://www.goodreads.com/search?query=${isbn}`\n\n  if (affiliateAbbr === AFFILIATES.AMAZON)\n    return `https://www.amazon.co.uk/dp/${makeIsbn10(\n      String(isbn)\n    )}?tag=thcdex-21`\n\n  if (affiliateAbbr === AFFILIATES.BOOK_DEPOSITORY)\n    return `https://bookdepository.com/search?searchTerm=${isbn}&a_id=char`\n}\n\nexport const getShortLink = (isbn: number, affiliateAbbr: string): string =>\n  `https://cha.rs/${affiliateAbbr}/${isbn.toString(36).toUpperCase()}`\n\nexport const getAffiliateLinks = (isbn: number): object => {\n  const long = {}\n  const short = {}\n\n  Object.values(AFFILIATES).forEach((affiliate: string) => {\n    long[affiliate] = getLink(isbn, affiliate)\n    short[affiliate] = getShortLink(isbn, affiliate)\n  })\n\n  return {\n    long,\n    short,\n  }\n}\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport { Book } from 'types/book'\nimport { AFFILIATES } from 'utils/urls/affiliates'\nimport { FONT } from 'styles/tokens'\n\nconst AFFILIATE_ACTIONS = {\n  [AFFILIATES.GOODREADS]: 'See on Goodreads',\n  [AFFILIATES.AMAZON]: 'Buy on Amazon',\n  [AFFILIATES.BOOK_DEPOSITORY]: 'Buy on Book Depository',\n}\n\nconst StyledLi = styled.li`\n  list-style: disc;\n  font-size: ${FONT.SIZE.S};\n`\n\ntype Props = Pick<Book, 'links'>\n\nconst BookAffiliates: React.FC<Props> = ({ links }) => (\n  <ol>\n    {Object.entries(AFFILIATE_ACTIONS).map(([affiliateAbbr, label]) => (\n      <StyledLi key={affiliateAbbr}>\n        <a href={links.long[affiliateAbbr]}>{label}</a>\n      </StyledLi>\n    ))}\n  </ol>\n)\n\nexport default BookAffiliates\n","'use strict';\n// 22.1.3.8 Array.prototype.find(predicate, thisArg = undefined)\nvar $export = require('./_export');\nvar $find = require('./_array-methods')(5);\nvar KEY = 'find';\nvar forced = true;\n// Shouldn't skip holes\nif (KEY in []) Array(1)[KEY](function () { forced = false; });\n$export($export.P + $export.F * forced, 'Array', {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\nrequire('./_add-to-unscopables')(KEY);\n","// https://github.com/tc39/proposal-object-values-entries\nvar $export = require('./_export');\nvar $values = require('./_object-to-array')(false);\n\n$export($export.S, 'Object', {\n  values: function values(it) {\n    return $values(it);\n  }\n});\n","import React from 'react'\nimport styled from 'styled-components'\nimport { Link } from 'gatsby'\nimport Img from 'gatsby-image'\n\nimport { VideoCardType } from 'types/video/card'\nimport { shortFormatDate } from 'utils/formatting/time'\nimport { formatViewCount } from 'utils/formatting/numbers'\nimport H from 'components/H'\nimport { COLOR, FONT, BORDER_RADIUS } from 'styles/tokens'\nimport StarRating from 'components/StarRating'\n\nconst StyledVideoCard = styled(Link)`\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  margin: 0;\n  overflow: hidden;\n  background: ${COLOR.BACKGROUND_DARK};\n  border-radius: ${BORDER_RADIUS.S};\n`\n\nconst StyledImg = styled(Img)`\n  box-shadow: 0 0.2em 0.5em rgba(0, 0, 0, 0.1);\n`\n\nconst StyledDetails = styled.div`\n  padding: 0.5em 0.5em 0.3em;\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  min-height: 4.8em;\n`\n\nconst StyledTimestamp = styled.p`\n  font-size: ${FONT.SIZE.S};\n  margin: 0;\n`\n\nconst StyledMeta = styled.p`\n  display: flex;\n  justify-content: space-between;\n  flex-flow: wrap-reverse;\n  font-size: ${FONT.SIZE.XS};\n  margin: 0;\n  opacity: 0.5;\n`\n\nconst StyledDatePublished = styled.time`\n  margin-right: 0.5em;\n`\n\nconst StyledH = styled(H)`\n  margin: 0;\n`\n\ninterface BookContentsProps {\n  isStars: boolean\n}\n\nconst StyledBookContentsWrapper = styled.div<BookContentsProps>`\n  font-size: ${({ isStars }): string => (isStars ? FONT.SIZE.S : FONT.SIZE.XS)};\n  margin: ${({ isStars }): number => (isStars ? 0.4 : 0.2)}em 0;\n  opacity: 0.75;\n`\n\ninterface Props {\n  video: VideoCardType\n  featured?: boolean\n  timestamp?: string\n}\n\nconst VideoCard: React.FC<Props> = ({ video, featured, timestamp }) => {\n  const featuredBookCount = (video.timestamps || []).filter(\n    (t) => t.book && t.book.id\n  ).length\n\n  return (\n    <StyledVideoCard\n      to={timestamp ? `${video.slug}?at=${timestamp}` : video.slug}\n      style={\n        {\n          background: featured && video.image.colors.lightVibrant,\n          color: featured && video.image.colors.darkMuted,\n          '--primary-color': video.image.colors.vibrant,\n        } as object\n      }\n    >\n      <StyledImg\n        key={video.image.childImageSharp.fluid.src}\n        fluid={video.image.childImageSharp.fluid}\n        style={{ background: video.image.colors.muted }}\n      />\n      <StyledDetails>\n        <div>\n          {timestamp && (\n            <StyledTimestamp>Featured at {timestamp} in</StyledTimestamp>\n          )}\n          <StyledH as=\"h2\" size=\"S\">\n            {video.title}\n          </StyledH>\n\n          <StyledBookContentsWrapper isStars={!!video.ownedBy}>\n            {video.ownedBy\n              ? video.ownedBy.frontmatter.rating7 && (\n                  <StarRating of7={video.ownedBy.frontmatter.rating7} />\n                )\n              : !timestamp &&\n                featuredBookCount > 0 && (\n                  <>\n                    Featuring {featuredBookCount} book\n                    {featuredBookCount > 1 && 's'}\n                  </>\n                )}\n          </StyledBookContentsWrapper>\n        </div>\n        <StyledMeta>\n          <StyledDatePublished>\n            {shortFormatDate(video.datePublished)}\n          </StyledDatePublished>\n          <div>{formatViewCount(video.viewCount)}</div>\n        </StyledMeta>\n      </StyledDetails>\n    </StyledVideoCard>\n  )\n}\n\nexport default VideoCard\n"],"sourceRoot":""}