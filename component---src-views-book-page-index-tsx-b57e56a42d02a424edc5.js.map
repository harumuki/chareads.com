{"version":3,"sources":["webpack:///./src/components/Reveal/index.tsx","webpack:///./src/utils/tracking/index.ts","webpack:///./src/components/RelatedBooks/index.tsx","webpack:///./node_modules/core-js/modules/es6.string.starts-with.js","webpack:///./src/views/BookPage/BookTitle.tsx","webpack:///./src/views/BookPage/BookImage.tsx","webpack:///./src/views/BookPage/BookReview.tsx","webpack:///./src/components/links/TagLink/index.tsx","webpack:///./src/views/BookPage/TagsList/index.tsx","webpack:///./src/views/BookPage/BookMeta.tsx","webpack:///./src/views/BookPage/index.tsx","webpack:///./src/components/MarkdownWrapper/index.tsx","webpack:///./src/utils/formatting/text.ts","webpack:///./src/utils/hooks/useWindowSize.ts","webpack:///./node_modules/core-js/modules/es6.array.find.js","webpack:///./node_modules/core-js/modules/es7.object.values.js","webpack:///./src/components/Reveal/RevealTrigger.tsx","webpack:///./src/utils/tags/index.ts","webpack:///./src/utils/urls/affiliates.ts","webpack:///./src/components/BookAffiliates/index.tsx","webpack:///./src/components/icons/PlayIcon.tsx","webpack:///./src/components/cards/VideoCard/index.tsx"],"names":["StyledContent","styled","div","isOpen","isTransitioning","Reveal","children","open","ariaId","className","as","useState","setIsOpen","setIsTransitioning","contentHeight","setContentHeight","contentEl","createRef","useEffect","ref","current","clientHeight","setTimeout","id","aria-hidden","style","maxHeight","trackEvent","action","category","label","data","window","gtag","event_category","event_label","StyledWrapper","StyledTitleGridItem","GridItem","screenMin","m","StyledGrid","Grid","FONT","SIZE","S","screen","l","RelatedBooks","books","featuredSlugs","ownedSlug","length","full","size","map","book","featured","slug","includes","key","span","spanFromM","spanFromL","hideDetails","$export","toLength","context","$startsWith","P","F","startsWith","searchString","that","this","index","Math","min","arguments","undefined","search","String","call","slice","StyledTitle","H","StyledSubtitle","StyledAuthor","BookTitle","title","subtitle","author","rating7","decorative","StarRating","of7","StyledBookImage","figure","BORDER_RADIUS","toVW","MARGIN_COLUMNS","L","COLUMN_WIDTH","GAP","xl","XL","StyledImg","Img","BookImage","image","bookHeight","background","colors","muted","fixed","childImageSharp","h200","media","BREAKPOINT","M","h300","h400","toFixed","backgroundColor","darkMuted","StyledBookReview","StyledSummary","BookReview","summary","html","isSummaryOpen","setisSummaryOpen","MarkdownWrapper","dangerouslySetInnerHTML","__html","RevealTrigger","onClick","StyledLink","Link","FILTER_UNDERLINE_STYLE","TagLink","tag","props","splitTagByPrefix","prefix","name","to","PATHS","BOOKS","StyledOl","ol","StyledLi","li","TagsList","tags","splitTags","splitTagsByPrefix","values","unprefixed","reduce","prev","curr","StyledRevealTrigger","StyledReveal","dl","trim","s","StyledDt","dt","WEIGHT","BOLD","StyledDd","dd","BookMeta","pageCount","dateBookPublished","publisher","series","readDates","dateLastRead","dateRated","dateReviewed","windowWidth","useWindowSize","width","readMoreThanOnce","formatYear","number","dateTime","toString","shortFormatDate","StyledBookTitle","StyledHeadlineGridItem","query","BookPage","timestampMentionData","featuredVideoData","location","videos","normalizeArray","singleVideo","relatedBooks","blockRowsForLeftColumn","ceil","Layout","navTitle","navTitleLink","description","stripHtml","shareImage","lightVibrant","darkVibrant","rows","rowsFromM","columnsFromM","columnsFromL","columnsFromXL","spanRowsFromM","spanRowsFromL","rowsFromL","marginBottom","BookAffiliates","links","video","foundTimestamp","timestamps","find","t","timestamp","formatTimestamp","spanFromXL","VideoCard","big","playsInline","hideOwnedByRating","COLOR","BACKGROUND_DARK","text","replace","sortAlphabetically","strings","sort","a","b","height","getSize","innerWidth","innerHeight","windowSize","setWindowSize","handleResize","addEventListener","removeEventListener","$find","forced","Array","callbackfn","$values","it","StyledSummaryTrigger","button","screenMax","StyledIcon","i","aria-expanded","aria-controls","tagPrefixNames","type","genre","sub","parts","split","join","resultMap","value","push","Object","keys","filter","p","getTagsFromBooks","forEach","dedupedTags","Set","orderedTags","filterBooksByTags","filterType","filterGenre","filterSubject","ignorePrefix","filteredBooks","AFFILIATES","GOODREADS","AMAZON","BOOK_DEPOSITORY","AFFILIATE_ACTIONS","StyledArrowIcon","ArrowIcon","entries","affiliateAbbr","href","long","PlayIcon","viewBox","d","YouTubePlayerConfig","youtube","playerVars","rel","controls","autoplay","StyledVideoCard","StyledPlayButton","StyledPlayIcon","BACKGROUND_LIGHT","StyledDuration","aside","$big","XS","XXS","StyledDetails","StyledTimestamp","StyledMeta","StyledDatePublished","time","StyledH","StyledBookContentsWrapper","isStars","playVideo","setPlayVideo","featuredBookCount","ownedBy","color","vibrant","AspectRatioWrapper","url","youtubeId","unformatTimestamp","config","e","preventDefault","fluid","w200","w350","aria-label","duration","datePublished","viewCount","parseInt","process","formatViewCount"],"mappings":"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","file":"component---src-views-book-page-index-tsx-b57e56a42d02a424edc5.js","sourcesContent":["import React, { useState, useEffect, createRef } from 'react'\nimport styled from 'styled-components'\n\nconst TRANSITION_DURATION_IN_MS = 200\n\ninterface ContentProps {\n  ref: React.RefObject<React.ReactNode>\n  isOpen: boolean\n  isTransitioning: boolean\n  contentHeight: number\n  className?: string\n  as?: string\n}\n\nconst StyledContent = styled.div<ContentProps>`\n  margin: 0;\n  will-change: opacity, max-height;\n  transition: opacity ${TRANSITION_DURATION_IN_MS}ms ease-in-out, max-height ${TRANSITION_DURATION_IN_MS}ms ease-in-out;\n  overflow: hidden;\n\n  ${({ isOpen, isTransitioning }): string =>\n    !isOpen &&\n    !isTransitioning &&\n    `\n      position: absolute;\n      opacity: 0;\n      pointer-events: none;\n  `}\n\n  ${({ isTransitioning }): string =>\n    isTransitioning &&\n    `\n      opacity: 0;\n      max-height: 0;\n  `}\n\n  ${({ isOpen }): string =>\n    isOpen &&\n    `\n      opacity: 1;\n  `}\n`\n\ninterface Props {\n  children: React.ReactNode\n  open: boolean\n  ariaId?: string\n  className?: string\n  as?: string\n}\n\nconst Reveal: React.FC<Props> = ({ children, open, ariaId, className, as }) => {\n  const [isOpen, setIsOpen] = useState(open)\n  const [isTransitioning, setIsTransitioning] = useState(false)\n  const [contentHeight, setContentHeight] = useState(null)\n  const contentEl = createRef<HTMLDivElement>()\n\n  useEffect(() => {\n    if (open) {\n      const ref = contentEl.current as HTMLElement\n      setContentHeight(ref.clientHeight)\n      setIsTransitioning(true)\n    } else {\n      setIsOpen(false)\n      setTimeout(() => setIsTransitioning(false), TRANSITION_DURATION_IN_MS)\n    }\n  }, [open])\n\n  useEffect(() => {\n    if (isTransitioning && !isOpen) setTimeout(() => setIsOpen(true), 50)\n  }, [isTransitioning])\n\n  return (\n    <StyledContent\n      className={className}\n      ref={contentEl}\n      isOpen={isOpen}\n      isTransitioning={isTransitioning}\n      id={ariaId}\n      aria-hidden={!isOpen}\n      as={as}\n      style={{\n        maxHeight: isOpen && contentHeight,\n      }}\n    >\n      {children}\n    </StyledContent>\n  )\n}\n\nexport default Reveal\n","/* eslint-disable @typescript-eslint/camelcase */\n\nexport const trackEvent = (\n  action: string,\n  category: string,\n  label: string,\n  data?: object\n): void => {\n  if (!window.gtag) return\n\n  window.gtag('event', action, {\n    event_category: category,\n    event_label: label,\n    ...data,\n  })\n}\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport Grid from 'components/Grid'\nimport GridItem from 'components/Grid/GridItem'\nimport H from 'components/H'\nimport { FONT } from 'styles/tokens'\nimport { screen, screenMin } from 'styles/responsive'\n\nimport { BookCardType } from 'types/book'\nimport BookCard from 'components/cards/BookCard'\n\nconst StyledWrapper = styled.div`\n  margin: 2em 0 1em;\n`\n\nconst StyledTitleGridItem = styled(GridItem)`\n  ${screenMin.m`\n    display: none;\n  `}\n`\n\nconst StyledGrid = styled(Grid)`\n  font-size: ${FONT.SIZE.S};\n\n  ${screen.l`\n    > *:nth-last-child(1) {\n      display: none;\n    }\n  `}\n`\n\ninterface Props {\n  books: BookCardType[]\n  featuredSlugs?: string[]\n  ownedSlug?: string\n}\n\nconst RelatedBooks: React.FC<Props> = ({ books, featuredSlugs, ownedSlug }) => {\n  if (!books || books.length === 0) return null\n\n  return (\n    <StyledWrapper>\n      <StyledGrid full>\n        <StyledTitleGridItem>\n          <H size=\"L\" as=\"h2\">\n            Related books\n          </H>\n        </StyledTitleGridItem>\n\n        {books.map(\n          (book: BookCardType): React.ReactNode => {\n            const featured = ownedSlug\n              ? ownedSlug === book.slug\n              : featuredSlugs && featuredSlugs.includes(book.slug)\n\n            return (\n              <GridItem key={book.id} span={1} spanFromM={3} spanFromL={2}>\n                <BookCard\n                  book={book}\n                  featured={featured}\n                  hideDetails={ownedSlug === book.slug}\n                />\n              </GridItem>\n            )\n          }\n        )}\n      </StyledGrid>\n    </StyledWrapper>\n  )\n}\n\nexport default RelatedBooks\n","// 21.1.3.18 String.prototype.startsWith(searchString [, position ])\n'use strict';\nvar $export = require('./_export');\nvar toLength = require('./_to-length');\nvar context = require('./_string-context');\nvar STARTS_WITH = 'startsWith';\nvar $startsWith = ''[STARTS_WITH];\n\n$export($export.P + $export.F * require('./_fails-is-regexp')(STARTS_WITH), 'String', {\n  startsWith: function startsWith(searchString /* , position = 0 */) {\n    var that = context(this, searchString, STARTS_WITH);\n    var index = toLength(Math.min(arguments.length > 1 ? arguments[1] : undefined, that.length));\n    var search = String(searchString);\n    return $startsWith\n      ? $startsWith.call(that, search, index)\n      : that.slice(index, index + search.length) === search;\n  }\n});\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport { Book } from 'types/book'\nimport StarRating from 'components/StarRating'\nimport H from 'components/H'\n\nconst StyledTitle = styled(H)`\n  margin: 0 0 0.25em;\n`\n\nconst StyledSubtitle = styled(H)`\n  margin: -0.25em 0 0.375em;\n  text-transform: lowercase;\n`\n\nconst StyledAuthor = styled(H)`\n  margin: 0.5em 0 1em;\n`\n\ntype Props = Pick<Book, 'title' | 'subtitle' | 'author' | 'rating7'>\n\nconst BookTitle: React.FC<Props> = ({ title, subtitle, author, rating7 }) => (\n  <>\n    <StyledTitle as=\"h2\" size=\"XXL\" decorative>\n      {title}\n    </StyledTitle>\n    {subtitle && (\n      <StyledSubtitle as=\"h3\" size=\"L\" decorative>\n        {subtitle}\n      </StyledSubtitle>\n    )}\n    <StyledAuthor as=\"h2\" size=\"M\">\n      by {author}\n    </StyledAuthor>\n\n    {rating7 && <StarRating of7={rating7} />}\n  </>\n)\n\nexport default BookTitle\n","import React from 'react'\nimport styled from 'styled-components'\nimport Img from 'gatsby-image'\n\nimport { Book } from 'types/book'\nimport { BORDER_RADIUS, BREAKPOINT } from 'styles/tokens'\nimport { screen, screenMin } from 'styles/responsive'\nimport { toVW, MARGIN_COLUMNS, COLUMN_WIDTH, GAP } from 'styles/layout'\n\nconst StyledBookImage = styled.figure`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n  margin: 0;\n  box-sizing: border-box;\n  padding: 1em 0;\n  width: 100%;\n  height: 100%;\n  border-radius: ${BORDER_RADIUS.S};\n\n  ${screenMin.l`\n    justify-content: start;\n  `}\n\n  ${screen.l`\n    padding-left: ${toVW(MARGIN_COLUMNS.L * (COLUMN_WIDTH.L + GAP.L))};\n  `}\n  ${screen.xl`\n    padding-left: ${toVW(MARGIN_COLUMNS.XL * (COLUMN_WIDTH.XL + GAP.XL))};\n  `}\n`\n\nconst StyledImg = styled(Img)`\n  box-shadow: 0 0.4em 1em rgba(0, 0, 0, 0.2), 0 0 0.6em rgba(0, 0, 0, 0.1);\n  vertical-align: bottom;\n  transform: scale(var(--book-scale));\n\n  ${screenMin.l`\n    transform-origin: 0% 50%;\n  `}\n`\n\ntype Props = Pick<Book, 'image' | 'bookHeight'>\n\nconst BookImage: React.FC<Props> = ({ image, bookHeight }) => (\n  <StyledBookImage style={{ background: image.colors.muted }}>\n    <StyledImg\n      fixed={[\n        {\n          ...image.childImageSharp.h200,\n          media: `(max-width: ${BREAKPOINT.M - 1}px)`,\n        },\n        {\n          ...image.childImageSharp.h300,\n          media: `(min-width: ${\n            BREAKPOINT.M\n          }px) and (max-width: ${BREAKPOINT.L - 1}px)`,\n        },\n        {\n          ...image.childImageSharp.h400,\n          media: `(min-width: ${BREAKPOINT.L}px)`,\n        },\n      ]}\n      style={{\n        '--book-scale': ((bookHeight || 198) / 220).toFixed(2),\n      }}\n      backgroundColor={image.colors.darkMuted}\n    />\n  </StyledBookImage>\n)\n\nexport default BookImage\n","import React, { useState } from 'react'\nimport styled from 'styled-components'\n\nimport { Book } from 'types/book'\nimport { FONT } from 'styles/tokens'\nimport { screenMin } from 'styles/responsive'\nimport MarkdownWrapper from 'components/MarkdownWrapper'\nimport Reveal from 'components/Reveal'\nimport RevealTrigger from 'components/Reveal/RevealTrigger'\n\nconst SUMMARY_ARIA_ID = 'book-summary'\n\nconst StyledBookReview = styled.div`\n  position: relative;\n\n  && {\n    margin-top: -1em;\n    ${screenMin.m`\n      margin-top: -0.25em;\n    `}\n    ${screenMin.l`\n      margin-bottom: 1em;\n    `}\n  }\n`\n\nconst StyledContent = styled.div`\n  margin: 0.5em 0 0.5em;\n\n  ${screenMin.m`\n    margin-bottom: 0 0 1em;\n  `}\n`\n\nconst StyledSummary = styled.div`\n  padding: 0.5em 0 0;\n  font-size: ${FONT.SIZE.S};\n`\n\ntype Props = Pick<Book, 'summary' | 'html'>\n\nconst BookReview: React.FC<Props> = ({ summary, html }) => {\n  const [isSummaryOpen, setisSummaryOpen] = useState(!html)\n\n  return (\n    <StyledBookReview>\n      {html && (\n        <StyledContent>\n          <MarkdownWrapper dangerouslySetInnerHTML={{ __html: html }} />\n        </StyledContent>\n      )}\n\n      <RevealTrigger\n        onClick={(): void => setisSummaryOpen(!isSummaryOpen)}\n        open={isSummaryOpen}\n        ariaId={SUMMARY_ARIA_ID}\n      >\n        Book blurb\n      </RevealTrigger>\n\n      <Reveal as={StyledSummary} open={isSummaryOpen} ariaId={SUMMARY_ARIA_ID}>\n        {summary}\n      </Reveal>\n    </StyledBookReview>\n  )\n}\n\nexport default BookReview\n","import React from 'react'\nimport styled from 'styled-components'\nimport { Link } from 'gatsby'\n\nimport { FILTER_UNDERLINE_STYLE } from 'styles/tokens'\nimport PATHS from 'routes/paths'\nimport { splitTagByPrefix } from 'utils/tags'\nimport { trackEvent } from 'utils/tracking'\n\nconst StyledLink = styled(Link)`\n  ${FILTER_UNDERLINE_STYLE};\n`\n\ninterface Props {\n  tag: string\n}\n\nconst TagLink: React.FC<Props> = ({ tag, ...props }) => {\n  const [prefix, name] = splitTagByPrefix(tag)\n  const to = `${PATHS.BOOKS}?${prefix}=${name}`\n\n  return (\n    <StyledLink\n      to={to}\n      onClick={(): void => trackEvent('book-filter', prefix, name)}\n      {...props}\n    />\n  )\n}\n\nexport default TagLink\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport { Book } from 'types/book'\nimport { FONT } from 'styles/tokens'\nimport { screenMin } from 'styles/responsive'\nimport { splitTagsByPrefix } from 'utils/tags'\nimport TagLink from 'components/links/TagLink'\n\nconst StyledOl = styled.ol`\n  margin: 1em 0;\n  font-size: ${FONT.SIZE.S};\n\n  ${screenMin.m`\n    margin: 1.5em 0;\n  `}\n`\n\nconst StyledLi = styled.li`\n  line-height: 1.25;\n  margin: 0.5em 0;\n`\n\ntype Props = Pick<Book, 'tags'>\n\nconst TagsList: React.FC<Props> = ({ tags }) => {\n  if (!tags || tags.length === 0) return null\n\n  const splitTags = splitTagsByPrefix(tags)\n\n  return (\n    <StyledOl>\n      {splitTags.map(({ prefix, values }) => (\n        <StyledLi key={prefix}>\n          <strong>{prefix}</strong> &ndash; {}\n          {values\n            .map((tag) => (\n              <TagLink tag={tag.unprefixed} key={tag.unprefixed}>\n                {tag.name}\n              </TagLink>\n            ))\n            .reduce(\n              (prev: React.ReactElement[], curr: React.ReactElement) =>\n                prev === null ? [curr] : [...prev, ', ', curr],\n              null\n            )}\n        </StyledLi>\n      ))}\n    </StyledOl>\n  )\n}\n\nexport default TagsList\n","import React, { useState } from 'react'\nimport styled from 'styled-components'\n\nimport { Book } from 'types/book'\nimport { shortFormatDate, formatYear } from 'utils/formatting/time'\nimport useWindowSize from 'utils/hooks/useWindowSize'\nimport { FONT, BREAKPOINT } from 'styles/tokens'\nimport { trim } from 'styles/helpers'\nimport { screen, screenMin } from 'styles/responsive'\nimport Reveal from 'components/Reveal'\nimport RevealTrigger from 'components/Reveal/RevealTrigger'\nimport TagsList from './TagsList'\n\nconst META_ARIA_ID = 'book-meta'\n\nconst StyledRevealTrigger = styled(RevealTrigger)`\n  ${screenMin.m`\n    display: none;\n  `}\n  margin-bottom: 0.5em;\n`\n\nconst StyledReveal = styled.dl`\n  ${trim}\n\n  ${screen.s`\n    padding: 0.5em 0 0.5em 1em;\n  `}\n`\n\nconst StyledDt = styled.dt`\n  font-size: ${FONT.SIZE.S};\n  font-weight: ${FONT.WEIGHT.BOLD};\n  margin: 0.5em 0 0;\n\n  ${screenMin.m`\n    margin: 1em 0 0;\n  `}\n`\n\nconst StyledDd = styled.dd`\n  font-size: ${FONT.SIZE.S};\n  margin: 0;\n`\n\ntype Props = Pick<\n  Book,\n  | 'pageCount'\n  | 'dateBookPublished'\n  | 'publisher'\n  | 'tags'\n  | 'series'\n  | 'readDates'\n  | 'dateLastRead'\n  | 'dateRated'\n  | 'dateReviewed'\n>\n\nconst BookMeta: React.FC<Props> = ({\n  pageCount,\n  dateBookPublished,\n  publisher,\n  tags,\n  series,\n  readDates,\n  dateLastRead,\n  dateRated,\n  dateReviewed,\n}) => {\n  const { width: windowWidth } = useWindowSize()\n  const [isOpen, setIsOpen] = useState(false)\n  const readMoreThanOnce = readDates.length > 1\n\n  return (\n    <>\n      <StyledRevealTrigger\n        onClick={(): void => setIsOpen(!isOpen)}\n        open={isOpen}\n        ariaId={META_ARIA_ID}\n      >\n        Book data\n      </StyledRevealTrigger>\n\n      <Reveal\n        as={StyledReveal}\n        open={(windowWidth && windowWidth > BREAKPOINT.S) || isOpen}\n        ariaId={META_ARIA_ID}\n      >\n        {pageCount && (\n          <>\n            <StyledDt>Page count</StyledDt>\n            <StyledDd>{pageCount}</StyledDd>\n          </>\n        )}\n        {dateBookPublished && (\n          <>\n            <StyledDt>First published</StyledDt>\n            <StyledDd>{formatYear(dateBookPublished)}</StyledDd>\n          </>\n        )}\n        {series && (\n          <>\n            <StyledDt>Series</StyledDt>\n            <StyledDd>\n              {series.title} #{series.number}\n            </StyledDd>\n          </>\n        )}\n        {publisher && (\n          <>\n            <StyledDt>Publisher</StyledDt>\n            <StyledDd>{publisher}</StyledDd>\n          </>\n        )}\n\n        <TagsList tags={tags} />\n\n        <StyledDt>History</StyledDt>\n        {dateLastRead && (\n          <>\n            {readMoreThanOnce && (\n              <StyledDd>Read {readDates.length} times</StyledDd>\n            )}\n            <StyledDd>\n              {readMoreThanOnce ? 'Last read' : 'Read'} on{' '}\n              <time dateTime={dateLastRead.toString()}>\n                {shortFormatDate(dateLastRead)}\n              </time>\n            </StyledDd>\n          </>\n        )}\n        {dateRated && (\n          <StyledDd>\n            Rated on {}\n            <time dateTime={dateRated.toString()}>\n              {shortFormatDate(dateRated)}\n            </time>\n          </StyledDd>\n        )}\n        {dateReviewed && (\n          <StyledDd>\n            Reviewed on {}\n            <time dateTime={dateReviewed.toString()}>\n              {shortFormatDate(dateReviewed)}\n            </time>\n          </StyledDd>\n        )}\n      </Reveal>\n    </>\n  )\n}\n\nexport default BookMeta\n","import React from 'react'\nimport styled from 'styled-components'\nimport { graphql } from 'gatsby'\n\nimport { PageProps } from 'types/page'\nimport { Book, BookCardType } from 'types/book'\nimport { VideoSnapshot, VideoCardType } from 'types/video'\nimport { normalizeArray } from 'utils/graphql/normalize'\nimport { stripHtml } from 'utils/formatting/text'\nimport PATHS from 'routes/paths'\nimport Layout from 'Layout'\nimport { screen, screenMin } from 'styles/responsive'\nimport Grid from 'components/Grid'\nimport GridItem from 'components/Grid/GridItem'\nimport VideoCard from 'components/cards/VideoCard'\nimport RelatedBooks from 'components/RelatedBooks'\nimport { formatTimestamp } from 'utils/formatting/time'\n\nimport BookTitle from './BookTitle'\nimport BookImage from './BookImage'\nimport BookReview from './BookReview'\nimport BookMeta from './BookMeta'\nimport BookAffiliates from '../../components/BookAffiliates'\n\nconst StyledGrid = styled(Grid)`\n  *::selection {\n    background: var(--primary-color);\n  }\n`\n\nconst StyledBookTitle = styled.div`\n  align-self: end;\n`\n\nconst StyledHeadlineGridItem = styled(GridItem)`\n  ${screen.m`\n    margin-bottom: 0.5em;\n  `}\n  ${screenMin.l`\n    margin-bottom: 1em;\n  `}\n`\n\ninterface Props extends PageProps {\n  data: {\n    book: Book\n    timestampMentionData: {\n      edges: {\n        node: VideoSnapshot\n      }[]\n    }\n    featuredVideoData: {\n      edges: {\n        node: VideoSnapshot\n      }[]\n    }\n    relatedbooksData: {\n      edges: {\n        node: BookCardType\n      }[]\n    }\n  }\n}\n\nconst BookPage: React.FC<Props> = ({\n  data: { book, timestampMentionData, featuredVideoData },\n  location,\n}) => {\n  const videos = [\n    ...normalizeArray(featuredVideoData),\n    ...normalizeArray(timestampMentionData),\n  ] as VideoSnapshot[]\n  const singleVideo = videos.length === 1\n\n  const relatedBooks = book.relatedBooks as BookCardType[]\n  const blockRowsForLeftColumn = 2 + Math.ceil(videos.length / 2)\n\n  return (\n    <Layout\n      location={location}\n      navTitle=\"Back to book reviews\"\n      navTitleLink={PATHS.BOOKS}\n      title={`${book.title} by ${book.author}`}\n      description={stripHtml(book.html) || book.summary}\n      shareImage={`${book.slug}/share.jpg`}\n    >\n      <StyledGrid\n        full\n        style={{\n          '--primary-color': book.image.colors.lightVibrant,\n          '--secondary-color': book.image.colors.darkVibrant,\n        }}\n      >\n        <StyledHeadlineGridItem\n          as={StyledBookTitle}\n          rows=\"2/3\"\n          rowsFromM=\"1/2\"\n          columnsFromM=\"5 / 12\"\n          columnsFromL=\"8 / 14\"\n          columnsFromXL=\"9 / 15\"\n        >\n          <BookTitle\n            title={book.title}\n            subtitle={book.subtitle}\n            author={book.author}\n            rating7={book.rating7}\n          />\n        </StyledHeadlineGridItem>\n\n        <StyledHeadlineGridItem\n          columnsFromM=\"1/5\"\n          columnsFromL=\"1/8\"\n          columnsFromXL=\"1/9\"\n        >\n          <BookImage image={book.image} bookHeight={book.bookHeight} />\n        </StyledHeadlineGridItem>\n\n        <GridItem\n          spanFromM={4}\n          spanFromL={3}\n          columnsFromL=\"2/5\"\n          columnsFromXL=\"3/6\"\n          spanRowsFromM={blockRowsForLeftColumn + 1}\n          spanRowsFromL={blockRowsForLeftColumn}\n        >\n          <BookMeta\n            pageCount={book.pageCount}\n            dateBookPublished={book.dateBookPublished}\n            publisher={book.publisher}\n            tags={book.tags}\n            series={book.series}\n            readDates={book.readDates}\n            dateLastRead={book.dateLastRead}\n            dateRated={book.dateRated}\n            dateReviewed={book.dateReviewed}\n          />\n        </GridItem>\n\n        <GridItem\n          spanFromM={8}\n          spanFromL={3}\n          columnsFromM=\"5/13\"\n          columnsFromL=\"5/8\"\n          columnsFromXL=\"6/9\"\n          rows=\"5\"\n          rowsFromM=\"3\"\n          rowsFromL={`2/${blockRowsForLeftColumn + 2}`}\n          style={{ marginBottom: '1em' }}\n        >\n          <BookAffiliates links={book.links} />\n        </GridItem>\n\n        <GridItem columnsFromM=\"5/13\" columnsFromL=\"8/15\" columnsFromXL=\"9/15\">\n          <BookReview summary={book.summary} html={book.html} />\n        </GridItem>\n\n        {videos.map((video) => {\n          const foundTimestamp = (video.timestamps || []).find(\n            (t) => t.book && t.book.id === book.id\n          )\n          const timestamp = foundTimestamp && formatTimestamp(foundTimestamp.t)\n\n          return (\n            <GridItem\n              key={video.id}\n              span={singleVideo ? 2 : 1}\n              spanFromM={singleVideo ? 8 : 4}\n              spanFromL={singleVideo ? 6 : 3}\n              spanFromXL={singleVideo ? 6 : 4}\n            >\n              <VideoCard\n                video={video as VideoCardType}\n                timestamp={timestamp}\n                big\n                playsInline\n                hideOwnedByRating\n              />\n            </GridItem>\n          )\n        })}\n      </StyledGrid>\n\n      <RelatedBooks books={relatedBooks} />\n    </Layout>\n  )\n}\n\nexport const query = graphql`\n  query BookPage($id: String!) {\n    book: book(id: { eq: $id }) {\n      ...BookFields\n    }\n    timestampMentionData: allVideo(\n      filter: { timestamps: { elemMatch: { book: { id: { eq: $id } } } } }\n      sort: { fields: datePublished, order: DESC }\n    ) {\n      edges {\n        node {\n          ...VideoSnapshotFields\n        }\n      }\n    }\n    featuredVideoData: allVideo(\n      filter: { ownedBy: { id: { eq: $id } } }\n      sort: { fields: datePublished, order: DESC }\n    ) {\n      edges {\n        node {\n          ...VideoSnapshotFields\n        }\n      }\n    }\n  }\n`\n\nexport default BookPage\n","import styled from 'styled-components'\nimport { COLOR, FONT } from 'styles/tokens'\nimport { trim } from 'styles/helpers'\n\nconst MarkdownWrapper = styled.div`\n  ${trim}\n\n  hr {\n    height: 0.1em;\n    background: ${COLOR.BACKGROUND_DARK};\n    border: 0;\n    margin: 1em 0;\n  }\n\n  blockquote {\n    margin-left: 0;\n    border-left: 0.2em solid ${COLOR.BACKGROUND_DARK};\n    padding-left: 1em;\n  }\n\n  h2 {\n    margin-top: 1em;\n    font-size: ${FONT.SIZE.M};\n  }\n\n  h3,\n  h4 {\n    margin-top: 1em;\n    font-size: ${FONT.SIZE.S};\n  }\n\n  img {\n    max-width: 100%;\n  }\n\n  ul {\n    list-style: disc;\n  }\n\n  ol {\n    list-style: decimal;\n  }\n\n  p,\n  ul,\n  ol {\n    margin: 0.5em 0;\n  }\n\n  ul,\n  ol {\n    padding-left: 1em;\n    ${trim}\n  }\n\n  li {\n    margin: 0.25em 0;\n  }\n\n  a {\n    text-decoration: underline;\n    text-decoration-color: var(--secondary-color);\n  }\n`\n\nexport default MarkdownWrapper\n","import { Book } from 'types/book'\n\nexport const getBookDetailsFromString = (\n  text: string\n): Pick<Book, 'title' | 'author'> | undefined => {\n  const referenceMatch = text.match(/^(.+), (.+)$/)\n  return (\n    referenceMatch && {\n      title: referenceMatch[1],\n      author: referenceMatch[2],\n    }\n  )\n}\n\nexport const formatBookDetails = ({\n  title,\n  author,\n}: Pick<Book, 'title' | 'author'>): string => `${title} by ${author}`\n\nexport const stripHtml = (text: string): string =>\n  text\n    .replace(/<\\/[^>]+><[^>/]+>/gm, ' ')\n    .replace(/<\\/?[^>]+>/g, '')\n    .replace(/ +/gm, ' ')\n    .trim()\n\nexport const sortAlphabetically = (strings: string[]): string[] =>\n  strings.sort((a, b) => (a < b ? -1 : a > b ? 1 : 0))\n","import { useState, useEffect } from 'react'\n\ninterface WindowSize {\n  width: number\n  height: number\n}\n\nconst useWindowSize = (): WindowSize => {\n  if (typeof window === 'undefined') {\n    return { width: null, height: null }\n  }\n\n  const getSize = (): WindowSize => ({\n    width: window.innerWidth,\n    height: window.innerHeight,\n  })\n\n  const [windowSize, setWindowSize] = useState(getSize)\n\n  useEffect(() => {\n    const handleResize = (): void => setWindowSize(getSize())\n\n    window.addEventListener('resize', handleResize)\n    return (): void => window.removeEventListener('resize', handleResize)\n  }, [])\n\n  return windowSize\n}\n\nexport default useWindowSize\n","'use strict';\n// 22.1.3.8 Array.prototype.find(predicate, thisArg = undefined)\nvar $export = require('./_export');\nvar $find = require('./_array-methods')(5);\nvar KEY = 'find';\nvar forced = true;\n// Shouldn't skip holes\nif (KEY in []) Array(1)[KEY](function () { forced = false; });\n$export($export.P + $export.F * forced, 'Array', {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\nrequire('./_add-to-unscopables')(KEY);\n","// https://github.com/tc39/proposal-object-values-entries\nvar $export = require('./_export');\nvar $values = require('./_object-to-array')(false);\n\n$export($export.S, 'Object', {\n  values: function values(it) {\n    return $values(it);\n  }\n});\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport { FONT } from 'styles/tokens'\nimport { screenMax } from 'styles/responsive'\nimport Link from 'components/links/Link'\n\nconst StyledSummaryTrigger = styled.button`\n  font-size: ${FONT.SIZE.S};\n  font-weight: ${FONT.WEIGHT.BOLD};\n\n  ${screenMax.s`\n    width: 100%;\n    text-align: left;\n  `}\n`\n\nconst StyledIcon = styled.i<Pick<Props, 'open'>>`\n  display: inline-block;\n  position: relative;\n  width: 1.25em;\n  height: 1.25em;\n  vertical-align: -0.3em;\n\n  &:before,\n  &:after {\n    content: '';\n    display: block;\n    position: absolute;\n    top: 50%;\n    left: 0.35em;\n    width: 0.7em;\n    height: 0.125em;\n    background: currentColor;\n    transform-origin: 50% 50%;\n    transform: translate(-50%, -50%);\n    transition: transform 0.2s linear;\n  }\n\n  ${({ open }): string =>\n    !open &&\n    `\n    &:before {\n      transform: translate(-50%, -50%) rotate(-90deg);\n    }\n  `}\n`\n\ninterface Props {\n  children: React.ReactNode\n  open: boolean\n  ariaId?: string\n  onClick: () => void\n  className?: string\n}\n\nconst RevealTrigger: React.FC<Props> = ({\n  children,\n  open,\n  ariaId,\n  onClick,\n  className,\n}) => (\n  <Link\n    onClick={onClick}\n    aria-expanded={open}\n    aria-controls={ariaId}\n    as={StyledSummaryTrigger}\n    className={className}\n  >\n    <StyledIcon open={open} />\n    {children}\n  </Link>\n)\n\nexport default RevealTrigger\n","import { sortAlphabetically } from 'utils/formatting/text'\n\nexport type TagPrefix = 'type' | 'genre' | 'sub'\n\nconst tagPrefixNames = {\n  type: 'Type',\n  genre: 'Genre',\n  sub: 'Subject',\n}\n\nexport interface BookWithTags {\n  tags: string[]\n}\n\nexport const splitTagByPrefix = (tag: string): [string, string, string] => {\n  const parts = tag.split('-')\n  return [parts[0], parts.slice(1).join('-'), tag]\n}\n\nexport const splitTagsByPrefix = (\n  tags: string[]\n): {\n  prefix: string\n  values: {\n    name: string\n    unprefixed: string\n  }[]\n}[] => {\n  const resultMap = tags\n    .map(splitTagByPrefix)\n    .reduce((prev, [prefix, name, unprefixed]) => {\n      const value = { name, unprefixed }\n      if (prev[prefix]) {\n        prev[prefix].push(value)\n      } else {\n        prev[prefix] = [value]\n      }\n      return prev\n    }, {})\n\n  return Object.keys(tagPrefixNames)\n    .filter((p) => resultMap[p])\n    .map((prefix) => ({\n      prefix: tagPrefixNames[prefix],\n      values: resultMap[prefix],\n    }))\n}\n\nexport const getTagsFromBooks = (\n  books: BookWithTags[],\n  prefix?: TagPrefix\n): string[] => {\n  const tags = []\n  books.forEach((b) => tags.push(...b.tags))\n  const dedupedTags = [...new Set(tags)]\n  const orderedTags = sortAlphabetically(dedupedTags)\n\n  if (!prefix) return orderedTags\n\n  return orderedTags\n    .filter((tag) => tag.startsWith(`${prefix}-`))\n    .map((tag) => tag.slice(prefix.length + 1))\n}\n\nexport const filterBooksByTags = (\n  books: BookWithTags[],\n  filterType?: string,\n  filterGenre?: string,\n  filterSubject?: string,\n  ignorePrefix?: TagPrefix\n): BookWithTags[] => {\n  let filteredBooks = books\n  if (filterType && ignorePrefix !== 'type')\n    filteredBooks = filteredBooks.filter((book) =>\n      book.tags.includes(`type-${filterType}`)\n    )\n  if (filterGenre && ignorePrefix !== 'genre')\n    filteredBooks = filteredBooks.filter((book) =>\n      book.tags.includes(`genre-${filterGenre}`)\n    )\n  if (filterSubject && ignorePrefix !== 'sub')\n    filteredBooks = filteredBooks.filter((book) =>\n      book.tags.includes(`sub-${filterSubject}`)\n    )\n\n  return filteredBooks\n}\n","import { makeIsbn10 } from 'utils/formatting/isbn'\n\nexport const AFFILIATES = {\n  GOODREADS: 'gr',\n  AMAZON: 'amzn',\n  BOOK_DEPOSITORY: 'bd',\n}\n\nexport const getLink = (isbn: string, affiliateAbbr: string): string => {\n  if (affiliateAbbr === AFFILIATES.GOODREADS)\n    return `https://www.goodreads.com/search?query=${isbn}`\n\n  if (affiliateAbbr === AFFILIATES.AMAZON)\n    return `https://www.amazon.co.uk/dp/${makeIsbn10(\n      String(isbn)\n    )}?tag=thcdex-21`\n\n  if (affiliateAbbr === AFFILIATES.BOOK_DEPOSITORY)\n    return `https://bookdepository.com/search?searchTerm=${isbn}&a_id=char`\n}\n\nexport const getShortLink = (isbn: string, affiliateAbbr: string): string =>\n  `https://cha.rs/${parseInt(isbn)\n    .toString(36)\n    .toUpperCase()}/${affiliateAbbr}`\n\nexport const getAffiliateLinks = (isbn: string): object => {\n  const long = {}\n  const short = {}\n\n  Object.values(AFFILIATES).forEach((affiliate: string) => {\n    long[affiliate] = getLink(isbn, affiliate)\n    short[affiliate] = getShortLink(isbn, affiliate)\n  })\n\n  return {\n    long,\n    short,\n  }\n}\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport { Book } from 'types/book'\nimport { AFFILIATES } from 'utils/urls/affiliates'\nimport { FONT } from 'styles/tokens'\nimport { screenMin } from 'styles/responsive'\nimport ArrowIcon from 'components/icons/ArrowIcon'\n\nconst AFFILIATE_ACTIONS = {\n  [AFFILIATES.GOODREADS]: 'See on Goodreads',\n  [AFFILIATES.AMAZON]: 'Buy on Amazon',\n  [AFFILIATES.BOOK_DEPOSITORY]: 'Buy on Book Depository',\n}\n\nconst StyledLi = styled.li`\n  font-size: ${FONT.SIZE.S};\n\n  ${screenMin.l`\n    margin-left: -1.5em;\n  `}\n`\n\nconst StyledArrowIcon = styled(ArrowIcon)`\n  margin: 0 0.75em 0 0;\n`\n\ntype Props = Pick<Book, 'links'>\n\nconst BookAffiliates: React.FC<Props> = ({ links }) => (\n  <ol>\n    {Object.entries(AFFILIATE_ACTIONS).map(([affiliateAbbr, label]) => (\n      <StyledLi key={affiliateAbbr}>\n        <a href={links.long[affiliateAbbr]}>\n          <StyledArrowIcon />\n          {label}\n        </a>\n      </StyledLi>\n    ))}\n  </ol>\n)\n\nexport default BookAffiliates\n","import React from 'react'\n\ninterface Props {\n  className?: string\n}\n\nconst PlayIcon: React.FC<Props> = ({ className }) => (\n  <svg viewBox=\"0 0 11 14\" className={className}>\n    <path d=\"M9.2,6.2l-7.5-5c-0.5-0.3-1.2,0-1.2,0.6v10.3c0,0.6,0.7,1,1.2,0.6l7.5-5C9.8,7.4,9.8,6.6,9.2,6.2z\" />\n  </svg>\n)\n\nexport default PlayIcon\n","import React, { useState } from 'react'\nimport styled from 'styled-components'\nimport { Link } from 'gatsby'\nimport Img from 'gatsby-image'\nimport YouTubePlayer from 'react-player/lib/players/YouTube'\n\nimport { VideoCardType } from 'types/video'\nimport { shortFormatDate, unformatTimestamp, formatTimestamp } from 'utils/formatting/time'\nimport { formatViewCount } from 'utils/formatting/numbers'\nimport H from 'components/H'\nimport { COLOR, FONT, BORDER_RADIUS, BREAKPOINT } from 'styles/tokens'\nimport StarRating from 'components/StarRating'\nimport AspectRatioWrapper from 'components/AspectRatioWrapper'\nimport PlayIcon from 'components/icons/PlayIcon'\n\nconst YouTubePlayerConfig = {\n  youtube: {\n    playerVars: {\n      rel: 0,\n      controls: 1,\n      autoplay: 1,\n    },\n  },\n}\n\nconst StyledVideoCard = styled(Link)`\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  margin: 0;\n  overflow: hidden;\n  background: ${COLOR.BACKGROUND_DARK};\n  border-radius: ${BORDER_RADIUS.S};\n`\n\nconst StyledPlayButton = styled.button`\n  position: absolute;\n  z-index: 1;\n  padding: 0.5em 0.6em;\n  line-height: 0;\n`\n\nconst StyledPlayIcon = styled(PlayIcon)`\n  width: 1em;\n  fill: ${COLOR.BACKGROUND_LIGHT};\n  filter: drop-shadow(0 0 2px rgba(0, 0, 0, 0.1));\n`\n\nconst StyledDuration = styled.aside`\n  position: absolute;\n  bottom: 0.25em;\n  right: 0.25em;\n  padding: 0 0.375em;\n  border-radius: 2px;\n  background: #00000088;\n  color: #ffffffcc;\n  font-size: ${({ $big }) => $big ? FONT.SIZE.XS : FONT.SIZE.XXS};\n`\n\nconst StyledImg = styled(Img)`\n  box-shadow: 0 0.2em 0.5em rgba(0, 0, 0, 0.1);\n`\n\nconst StyledDetails = styled.div`\n  padding: 0.5em 0.5em 0.3em;\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  min-height: 4.8em;\n`\n\nconst StyledTimestamp = styled.p`\n  font-size: ${FONT.SIZE.S};\n  margin: 0;\n`\n\nconst StyledMeta = styled.p`\n  display: flex;\n  justify-content: space-between;\n  flex-flow: wrap-reverse;\n  font-size: ${FONT.SIZE.XS};\n  margin: 0;\n  opacity: 0.5;\n`\n\nconst StyledDatePublished = styled.time`\n  margin-right: 0.5em;\n`\n\nconst StyledH = styled(H)`\n  margin: 0;\n`\n\ninterface BookContentsProps {\n  isStars: boolean\n}\n\nconst StyledBookContentsWrapper = styled.div<BookContentsProps>`\n  font-size: ${({ isStars }): string =>\n    isStars ? FONT.SIZE.XXS : FONT.SIZE.XS};\n  margin: ${({ isStars }): number => (isStars ? 0.4 : 0.2)}em 0;\n  opacity: 0.75;\n`\n\ninterface Props {\n  video: VideoCardType\n  featured?: boolean\n  timestamp?: string\n  big?: boolean\n  playsInline?: boolean\n  hideOwnedByRating?: boolean\n  className?: string\n}\n\nconst VideoCard: React.FC<Props> = ({\n  video,\n  featured,\n  timestamp,\n  big,\n  playsInline,\n  hideOwnedByRating,\n  className,\n}) => {\n  const [playVideo, setPlayVideo] = useState(false)\n  const featuredBookCount =\n    (video.timestamps || []).filter((t) => t.book && t.book.id).length +\n    (video.ownedBy ? 1 : 0)\n\n  return (\n    <StyledVideoCard\n      to={timestamp ? `${video.slug}?at=${timestamp}` : video.slug}\n      style={\n        {\n          background: featured && video.image.colors.lightVibrant,\n          color: featured && video.image.colors.darkMuted,\n          '--primary-color': video.image.colors.vibrant,\n        } as object\n      }\n      className={className}\n    >\n      <AspectRatioWrapper style={{ backgroundColor: video.image.colors.muted }}>\n        {playVideo ? (\n          <YouTubePlayer\n            url={`https://www.youtube.com/watch?v=${\n              video.youtubeId\n            }${timestamp && `&t=${unformatTimestamp(timestamp)}`}`}\n            config={YouTubePlayerConfig}\n            width=\"100%\"\n            height=\"100%\"\n          />\n        ) : (\n          <div>\n            {playsInline && (\n              <StyledPlayButton\n                onClick={(e): void => {\n                  e.preventDefault()\n                  setPlayVideo(true)\n                }}\n              >\n                <StyledPlayIcon />\n              </StyledPlayButton>\n            )}\n            <StyledImg\n              fluid={\n                big\n                  ? [\n                      {\n                        ...video.image.childImageSharp.w200,\n                        media: `(max-width: ${BREAKPOINT.M - 1}px)`,\n                      },\n                      {\n                        ...video.image.childImageSharp.w350,\n                        media: `(min-width: ${BREAKPOINT.M}px)`,\n                      },\n                    ]\n                  : video.image.childImageSharp.w200\n              }\n            />\n            <StyledDuration $big={big} aria-label=\"duration\">{formatTimestamp(video.duration)}</StyledDuration>\n          </div>\n        )}\n      </AspectRatioWrapper>\n      <StyledDetails>\n        <div>\n          {timestamp && (\n            <StyledTimestamp>Featured at {timestamp} in</StyledTimestamp>\n          )}\n          <StyledH as=\"h2\" size=\"S\">\n            {video.title}\n          </StyledH>\n\n          <StyledBookContentsWrapper isStars={!!video.ownedBy}>\n            {video.ownedBy && !hideOwnedByRating\n              ? video.ownedBy.rating7 && (\n                  <StarRating of7={video.ownedBy.rating7} />\n                )\n              : !timestamp &&\n                featuredBookCount > 1 && (\n                  <>\n                    Featuring {featuredBookCount} book\n                    {featuredBookCount > 1 && 's'}\n                  </>\n                )}\n          </StyledBookContentsWrapper>\n        </div>\n        <StyledMeta>\n          <StyledDatePublished>\n            {shortFormatDate(video.datePublished)}\n          </StyledDatePublished>\n          {video.viewCount >\n            parseInt(process.env.GATSBY_YOUTUBE_VIEWS_MINIMUM_VISIBLE) && (\n            <span>{formatViewCount(video.viewCount)}</span>\n          )}\n        </StyledMeta>\n      </StyledDetails>\n    </StyledVideoCard>\n  )\n}\n\nexport default VideoCard\n"],"sourceRoot":""}