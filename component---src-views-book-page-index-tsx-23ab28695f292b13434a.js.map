{"version":3,"sources":["webpack:///./src/views/BookPage/BookTitle.tsx","webpack:///./src/views/BookPage/BookImage.tsx","webpack:///./src/views/BookPage/BookReview.tsx","webpack:///./src/views/BookPage/TagsList/utils.ts","webpack:///./src/views/BookPage/TagsList/index.tsx","webpack:///./src/views/BookPage/BookMeta.tsx","webpack:///./src/components/RelatedBooks/index.tsx","webpack:///./src/views/BookPage/index.tsx","webpack:///./src/utils/urls/affiliates.ts","webpack:///./src/views/BookPage/BookAffiliates.tsx","webpack:///./node_modules/core-js/modules/es6.array.find.js","webpack:///./node_modules/core-js/modules/es7.object.values.js","webpack:///./src/components/cards/VideoCard/index.tsx"],"names":["StyledTitle","styled","H","StyledAuthor","BookTitle","title","author","rating7","as","size","decorative","StarRating","of7","StyledBookImage","figure","BORDER_RADIUS","S","screenMax","m","screen","l","toVW","MARGIN_COLUMNS","L","COLUMN_WIDTH","GAP","xl","XL","StyledImg","Img","screenMin","BookImage","image","bookHeight","style","background","colors","muted","fixed","childImageSharp","h200","media","BREAKPOINT","M","h300","h400","toFixed","backgroundColor","darkMuted","StyledBookReview","div","BookReview","summary","html","fontSize","dangerouslySetInnerHTML","__html","tagPrefixNames","type","genre","sub","StyledOl","ol","FONT","SIZE","StyledLi","li","TagsList","tags","length","splitTags","resultMap","forEach","tag","parts","split","prefix","value","slice","join","push","Object","keys","filter","p","map","values","splitTagsByPrefix","key","StyledDt","dt","WEIGHT","BOLD","StyledDd","dd","BookMeta","pageCount","dateBookPublished","publisher","readDates","dateRated","dateReviewed","formatYear","shortFormatDate","StyledWrapper","StyledGrid","Grid","RelatedBooks","books","full","book","featured","GridItem","id","span","spanFromM","spanFromL","BookCard","StyledMeta","aside","StyledBookTitle","query","BookPage","data","bookData","timestampMentionData","featuredVideoData","location","normalizeItem","timestampMentions","normalizeArray","featuredVideos","relatedBooks","Layout","rows","rowsFromM","columnsFromM","columnsFromL","columnsFromXL","spanRowsFromM","Math","ceil","BookAffiliates","links","video","spanFromXL","VideoCard","big","mention","timestamp","formatTimestamp","timestamps","find","t","AFFILIATES","GOODREADS","AMAZON","BOOK_DEPOSITORY","AFFILIATE_ACTIONS","entries","affiliateAbbr","label","href","long","$export","$find","forced","Array","P","F","callbackfn","this","arguments","undefined","$values","it","StyledVideoCard","Link","COLOR","BACKGROUND_DARK","StyledDetails","StyledTimestamp","XS","StyledDatePublished","time","StyledH","StyledBookContentsWrapper","isStars","featuredBookCount","to","slug","lightVibrant","color","vibrant","fluid","w200","w350","ownedBy","frontmatter","datePublished","formatViewCount","viewCount"],"mappings":"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","file":"component---src-views-book-page-index-tsx-23ab28695f292b13434a.js","sourcesContent":["import React from 'react'\nimport styled from 'styled-components'\n\nimport { Book } from 'types/book'\nimport StarRating from 'components/StarRating'\nimport H from 'components/H'\n\nconst StyledTitle = styled(H)`\n  margin: 0;\n`\n\nconst StyledAuthor = styled(H)`\n  margin: 0.5em 0 1em;\n`\n\ntype Props = Pick<Book, 'title' | 'author' | 'rating7'>\n\nconst BookTitle: React.FC<Props> = ({ title, author, rating7 }) => (\n  <>\n    <StyledTitle as=\"h2\" size=\"XXL\" decorative>\n      {title}\n    </StyledTitle>\n    <StyledAuthor as=\"h2\" size=\"M\">\n      by {author}\n    </StyledAuthor>\n\n    {rating7 && <StarRating of7={rating7} />}\n  </>\n)\n\nexport default BookTitle\n","import React from 'react'\nimport styled from 'styled-components'\nimport Img from 'gatsby-image'\n\nimport { Book } from 'types/book'\nimport { BORDER_RADIUS, BREAKPOINT } from 'styles/tokens'\nimport { screen, screenMax, screenMin } from 'styles/responsive'\nimport { toVW, MARGIN_COLUMNS, COLUMN_WIDTH, GAP } from 'styles/layout'\n\nconst StyledBookImage = styled.figure`\n  position: relative;\n  margin: 0;\n  box-sizing: border-box;\n  padding: 1em 0;\n  width: 100%;\n  border-radius: ${BORDER_RADIUS.S};\n\n  ${screenMax.m`\n    text-align: center;\n  `}\n\n  ${screen.l`\n    padding-left: ${toVW(MARGIN_COLUMNS.L * (COLUMN_WIDTH.L + GAP.L))};\n  `}\n  ${screen.xl`\n    padding-left: ${toVW(MARGIN_COLUMNS.XL * (COLUMN_WIDTH.XL + GAP.XL))};\n  `}\n`\n\nconst StyledImg = styled(Img)`\n  box-shadow: 0 0.4em 1em rgba(0, 0, 0, 0.2), 0 0 0.6em rgba(0, 0, 0, 0.1);\n  vertical-align: bottom;\n  transform: scale(var(--book-scale));\n\n  ${screenMin.l`\n    transform-origin: 0% 50%;\n  `}\n`\n\ntype Props = Pick<Book, 'image' | 'bookHeight'>\n\nconst BookImage: React.FC<Props> = ({ image, bookHeight }) => (\n  <StyledBookImage style={{ background: image.colors.muted }}>\n    <StyledImg\n      fixed={[\n        {\n          ...image.childImageSharp.h200,\n          media: `(max-width: ${BREAKPOINT.M - 1}px)`,\n        },\n        {\n          ...image.childImageSharp.h300,\n          media: `(min-width: ${\n            BREAKPOINT.M\n          }px) and (max-width: ${BREAKPOINT.L - 1}px)`,\n        },\n        {\n          ...image.childImageSharp.h400,\n          media: `(min-width: ${BREAKPOINT.L}px)`,\n        },\n      ]}\n      style={{\n        '--book-scale': ((bookHeight || 198) / 220).toFixed(2),\n      }}\n      backgroundColor={image.colors.darkMuted}\n    />\n  </StyledBookImage>\n)\n\nexport default BookImage\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport { Book } from 'types/book'\n\nconst StyledBookReview = styled.div`\n  margin-top: 1em;\n`\n\ntype Props = Pick<Book, 'summary' | 'html'>\n\nconst BookReview: React.FC<Props> = ({ summary, html }) => (\n  <StyledBookReview>\n    {summary && (\n      <details style={{ fontSize: '0.75em' }}>\n        <summary>Book sumary</summary>\n        {summary}\n      </details>\n    )}\n\n    {html && <div dangerouslySetInnerHTML={{ __html: html }} />}\n  </StyledBookReview>\n)\n\nexport default BookReview\n","const tagPrefixNames = {\n  type: 'Type',\n  genre: 'Genre',\n  sub: 'Subject',\n}\n\nexport const splitTagsByPrefix = (\n  tags: string[]\n): {\n  prefix: string\n  values: string[]\n}[] => {\n  const resultMap = {}\n\n  tags.forEach((tag) => {\n    const parts = tag.split('-')\n    if (parts.length === 1) return\n\n    const prefix = parts[0]\n\n    const value = parts.slice(1).join('-')\n\n    if (!resultMap[prefix]) return (resultMap[prefix] = [value])\n\n    resultMap[prefix].push(value)\n  })\n\n  return Object.keys(tagPrefixNames)\n    .filter((p) => resultMap[p])\n    .map((prefix) => ({\n      prefix: tagPrefixNames[prefix],\n      values: resultMap[prefix],\n    }))\n}\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport { Book } from 'types/book'\nimport { FONT } from 'styles/tokens'\nimport { splitTagsByPrefix } from './utils'\n\nconst StyledOl = styled.ol`\n  margin: 0;\n  font-size: ${FONT.SIZE.S};\n\n  span + span:before {\n    content: ', ';\n  }\n`\n\nconst StyledLi = styled.li`\n  line-height: 1.25;\n  margin: 0.5em 0;\n`\n\ntype Props = Pick<Book, 'tags'>\n\nconst TagsList: React.FC<Props> = ({ tags }) => {\n  if (!tags || tags.length === 0) return null\n\n  const splitTags = splitTagsByPrefix(tags)\n\n  return (\n    <StyledOl>\n      {splitTags.map(({ prefix, values }) => (\n        <StyledLi key={prefix}>\n          <strong>{prefix}</strong> &ndash; {}\n          {values.map((value) => (\n            <span key={value}>{value}</span>\n          ))}\n        </StyledLi>\n      ))}\n    </StyledOl>\n  )\n}\n\nexport default TagsList\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport { Book } from 'types/book'\nimport { shortFormatDate, formatYear } from 'utils/formatting/time'\nimport { FONT } from 'styles/tokens'\nimport TagsList from './TagsList'\n\nconst StyledDt = styled.dt`\n  font-size: ${FONT.SIZE.S};\n  font-weight: ${FONT.WEIGHT.BOLD};\n`\n\nconst StyledDd = styled.dd`\n  font-size: ${FONT.SIZE.S};\n  margin: 0 0 1em;\n`\n\ntype Props = Pick<\n  Book,\n  | 'pageCount'\n  | 'dateBookPublished'\n  | 'publisher'\n  | 'tags'\n  | 'readDates'\n  | 'dateRated'\n  | 'dateReviewed'\n>\n\nconst BookMeta: React.FC<Props> = ({\n  pageCount,\n  dateBookPublished,\n  publisher,\n  tags,\n  readDates,\n  dateRated,\n  dateReviewed,\n}) => (\n  <div>\n    <dl>\n      {pageCount && (\n        <>\n          <StyledDt>Page count</StyledDt>\n          <StyledDd>{pageCount}</StyledDd>\n        </>\n      )}\n      {dateBookPublished && (\n        <>\n          <StyledDt>Year published</StyledDt>\n          <StyledDd>{formatYear(dateBookPublished)}</StyledDd>\n        </>\n      )}\n      {publisher && (\n        <>\n          <StyledDt>Publisher</StyledDt>\n          <StyledDd>{publisher}</StyledDd>\n        </>\n      )}\n\n      <TagsList tags={tags} />\n    </dl>\n\n    <dl>\n      {readDates.length > 0 && (\n        <>\n          <StyledDt>Date read</StyledDt>\n          <StyledDd>\n            {shortFormatDate(readDates[readDates.length - 1][1])}\n          </StyledDd>\n        </>\n      )}\n      {dateRated && (\n        <>\n          <StyledDt>Date rated</StyledDt>\n          <StyledDd>{shortFormatDate(dateRated)}</StyledDd>\n        </>\n      )}\n      {dateReviewed && (\n        <>\n          <StyledDt>Date reviewed</StyledDt>\n          <StyledDd>{shortFormatDate(dateReviewed)}</StyledDd>\n        </>\n      )}\n    </dl>\n  </div>\n)\n\nexport default BookMeta\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport Grid from 'components/Grid'\nimport GridItem from 'components/Grid/GridItem'\nimport { FONT } from 'styles/tokens'\nimport { screen } from 'styles/responsive'\n\nimport { BookCardType } from 'types/book/card'\nimport BookCard from 'components/cards/BookCard'\n\nconst StyledWrapper = styled.div`\n  margin: 1.5em 0;\n`\n\nconst StyledGrid = styled(Grid)`\n  font-size: ${FONT.SIZE.S};\n\n  ${screen.l`\n    > *:nth-last-child(1) {\n      display: none;\n    }\n  `}\n`\n\ninterface Props {\n  books: BookCardType[]\n}\n\nconst RelatedBooks: React.FC<Props> = ({ books }) => (\n  <StyledWrapper>\n    <StyledGrid full>\n      {books.map(\n        (book: BookCardType): React.ReactNode => {\n          const featured = book.rating7 >= 6\n          return (\n            <GridItem key={book.id} span={1} spanFromM={3} spanFromL={2}>\n              <BookCard book={book} featured={featured} />\n            </GridItem>\n          )\n        }\n      )}\n    </StyledGrid>\n  </StyledWrapper>\n)\n\nexport default RelatedBooks\n","import React from 'react'\nimport styled from 'styled-components'\nimport { graphql } from 'gatsby'\n\nimport { PageProps } from 'types/page'\nimport { RawBook, Book } from 'types/book'\nimport { RawVideoSnapshot, VideoSnapshot } from 'types/video/snapshot'\nimport { normalizeItem, normalizeArray } from 'utils/graphql/normalize'\nimport Layout from 'Layout'\nimport Grid from 'components/Grid'\nimport GridItem from 'components/Grid/GridItem'\nimport VideoCard from 'components/cards/VideoCard'\nimport { screen, screenMin } from 'styles/responsive'\nimport { GAP, toVW } from 'styles/layout'\nimport { formatTimestamp } from 'utils/formatting/time'\n\nimport BookTitle from './BookTitle'\nimport BookImage from './BookImage'\nimport BookReview from './BookReview'\nimport BookMeta from './BookMeta'\nimport BookAffiliates from './BookAffiliates'\nimport { VideoCardType } from 'types/video/card'\nimport { BookCardType, RawBookCard } from 'types/book/card'\nimport RelatedBooks from 'components/RelatedBooks'\n\nconst StyledMeta = styled.aside`\n  ${screenMin.l`\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    grid-gap: ${toVW(GAP.L)};\n  `}\n\n  ${screen.xl`\n    grid-gap: ${toVW(GAP.XL)};\n  `}\n`\n\nconst StyledBookTitle = styled.div`\n  align-self: end;\n`\n\ninterface Props extends PageProps {\n  data: {\n    bookData: RawBook\n    timestampMentionData: {\n      edges: {\n        node: RawVideoSnapshot\n      }[]\n    }\n    featuredVideoData: {\n      edges: {\n        node: RawVideoSnapshot\n      }[]\n    }\n    relatedbooksData: {\n      edges: {\n        node: RawBookCard\n      }[]\n    }\n  }\n}\n\nconst BookPage: React.FC<Props> = ({\n  data: { bookData, timestampMentionData, featuredVideoData },\n  location,\n}) => {\n  const book = normalizeItem(bookData) as Book\n  const timestampMentions = normalizeArray(\n    timestampMentionData\n  ) as VideoSnapshot[]\n  const featuredVideos = normalizeArray(featuredVideoData) as VideoSnapshot[]\n  const relatedBooks = book.relatedBooks.map(normalizeItem) as BookCardType[]\n\n  return (\n    <Layout location={location}>\n      <Grid full>\n        <GridItem\n          as={StyledBookTitle}\n          rows=\"2/3\"\n          rowsFromM=\"1/2\"\n          columnsFromM=\"7 / 12\"\n          columnsFromL=\"8 / 14\"\n          columnsFromXL=\"9 / 15\"\n        >\n          <BookTitle\n            title={book.title}\n            author={book.author}\n            rating7={book.rating7}\n          />\n        </GridItem>\n\n        <GridItem columnsFromM=\"1/7\" columnsFromL=\"1/8\" columnsFromXL=\"1/9\">\n          <BookImage image={book.image} bookHeight={book.bookHeight} />\n        </GridItem>\n\n        <GridItem\n          as={StyledMeta}\n          spanFromM={4}\n          columnsFromL=\"2/8\"\n          columnsFromXL=\"3/9\"\n          spanRowsFromM={\n            2 +\n            Math.ceil((timestampMentions.length + featuredVideos.length) / 2)\n          }\n        >\n          <BookMeta\n            pageCount={book.pageCount}\n            dateBookPublished={book.dateBookPublished}\n            publisher={book.publisher}\n            tags={book.tags}\n            readDates={book.readDates}\n            dateRated={book.dateRated}\n            dateReviewed={book.dateReviewed}\n          />\n\n          <BookAffiliates links={book.links} />\n        </GridItem>\n\n        <GridItem columnsFromM=\"5/13\" columnsFromL=\"8/15\" columnsFromXL=\"9/15\">\n          <BookReview summary={book.summary} html={book.html} />\n        </GridItem>\n\n        {featuredVideos.map((video) => (\n          <GridItem\n            key={video.id}\n            span={1}\n            spanFromM={4}\n            spanFromL={3}\n            spanFromXL={4}\n          >\n            <VideoCard video={video as VideoCardType} big />\n          </GridItem>\n        ))}\n\n        {timestampMentions.map((mention) => {\n          const timestamp = formatTimestamp(\n            mention.timestamps.find((t) => t.book && t.book.id === book.id).t\n          )\n\n          return (\n            <GridItem\n              key={mention.id}\n              span={1}\n              spanFromM={4}\n              spanFromL={3}\n              spanFromXL={4}\n            >\n              <VideoCard\n                video={mention as VideoCardType}\n                timestamp={timestamp}\n                big\n              />\n            </GridItem>\n          )\n        })}\n      </Grid>\n\n      <RelatedBooks books={relatedBooks} />\n    </Layout>\n  )\n}\n\nexport const query = graphql`\n  query BookPage($id: String!) {\n    bookData: markdownRemark(id: { eq: $id }) {\n      ...BookFields\n    }\n    timestampMentionData: allVideos(\n      filter: { timestamps: { elemMatch: { book: { id: { eq: $id } } } } }\n    ) {\n      edges {\n        node {\n          ...VideoSnapshotFields\n        }\n      }\n    }\n    featuredVideoData: allVideos(\n      filter: { ownedBy: { id: { eq: $id } } }\n      sort: { fields: datePublished, order: DESC }\n    ) {\n      edges {\n        node {\n          ...VideoSnapshotFields\n        }\n      }\n    }\n  }\n`\n\nexport default BookPage\n","import { makeIsbn10 } from 'utils/formatting/isbn'\n\nexport const AFFILIATES = {\n  GOODREADS: 'gr',\n  AMAZON: 'amzn',\n  BOOK_DEPOSITORY: 'bd',\n}\n\nexport const getLink = (isbn: number, affiliateAbbr: string): string => {\n  if (affiliateAbbr === AFFILIATES.GOODREADS)\n    return `https://www.goodreads.com/search?query=${isbn}`\n\n  if (affiliateAbbr === AFFILIATES.AMAZON)\n    return `https://www.amazon.co.uk/dp/${makeIsbn10(\n      String(isbn)\n    )}?tag=thcdex-21`\n\n  if (affiliateAbbr === AFFILIATES.BOOK_DEPOSITORY)\n    return `https://bookdepository.com/search?searchTerm=${isbn}&a_id=char`\n}\n\nexport const getShortLink = (isbn: number, affiliateAbbr: string): string =>\n  `https://cha.rs/${affiliateAbbr}/${isbn.toString(36).toUpperCase()}`\n\nexport const getAffiliateLinks = (isbn: number): object => {\n  const long = {}\n  const short = {}\n\n  Object.values(AFFILIATES).forEach((affiliate: string) => {\n    long[affiliate] = getLink(isbn, affiliate)\n    short[affiliate] = getShortLink(isbn, affiliate)\n  })\n\n  return {\n    long,\n    short,\n  }\n}\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport { Book } from 'types/book'\nimport { AFFILIATES } from 'utils/urls/affiliates'\nimport { FONT } from 'styles/tokens'\n\nconst AFFILIATE_ACTIONS = {\n  [AFFILIATES.GOODREADS]: 'See on Goodreads',\n  [AFFILIATES.AMAZON]: 'Buy on Amazon',\n  [AFFILIATES.BOOK_DEPOSITORY]: 'Buy on Book Depository',\n}\n\nconst StyledLi = styled.li`\n  list-style: disc;\n  font-size: ${FONT.SIZE.S};\n`\n\ntype Props = Pick<Book, 'links'>\n\nconst BookAffiliates: React.FC<Props> = ({ links }) => (\n  <ol>\n    {Object.entries(AFFILIATE_ACTIONS).map(([affiliateAbbr, label]) => (\n      <StyledLi key={affiliateAbbr}>\n        <a href={links.long[affiliateAbbr]}>{label}</a>\n      </StyledLi>\n    ))}\n  </ol>\n)\n\nexport default BookAffiliates\n","'use strict';\n// 22.1.3.8 Array.prototype.find(predicate, thisArg = undefined)\nvar $export = require('./_export');\nvar $find = require('./_array-methods')(5);\nvar KEY = 'find';\nvar forced = true;\n// Shouldn't skip holes\nif (KEY in []) Array(1)[KEY](function () { forced = false; });\n$export($export.P + $export.F * forced, 'Array', {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\nrequire('./_add-to-unscopables')(KEY);\n","// https://github.com/tc39/proposal-object-values-entries\nvar $export = require('./_export');\nvar $values = require('./_object-to-array')(false);\n\n$export($export.S, 'Object', {\n  values: function values(it) {\n    return $values(it);\n  }\n});\n","import React from 'react'\nimport styled from 'styled-components'\nimport { Link } from 'gatsby'\nimport Img from 'gatsby-image'\n\nimport { VideoCardType } from 'types/video/card'\nimport { shortFormatDate } from 'utils/formatting/time'\nimport { formatViewCount } from 'utils/formatting/numbers'\nimport H from 'components/H'\nimport { COLOR, FONT, BORDER_RADIUS, BREAKPOINT } from 'styles/tokens'\nimport StarRating from 'components/StarRating'\n\nconst StyledVideoCard = styled(Link)`\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  margin: 0;\n  overflow: hidden;\n  background: ${COLOR.BACKGROUND_DARK};\n  border-radius: ${BORDER_RADIUS.S};\n`\n\nconst StyledImg = styled(Img)`\n  box-shadow: 0 0.2em 0.5em rgba(0, 0, 0, 0.1);\n`\n\nconst StyledDetails = styled.div`\n  padding: 0.5em 0.5em 0.3em;\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  min-height: 4.8em;\n`\n\nconst StyledTimestamp = styled.p`\n  font-size: ${FONT.SIZE.S};\n  margin: 0;\n`\n\nconst StyledMeta = styled.p`\n  display: flex;\n  justify-content: space-between;\n  flex-flow: wrap-reverse;\n  font-size: ${FONT.SIZE.XS};\n  margin: 0;\n  opacity: 0.5;\n`\n\nconst StyledDatePublished = styled.time`\n  margin-right: 0.5em;\n`\n\nconst StyledH = styled(H)`\n  margin: 0;\n`\n\ninterface BookContentsProps {\n  isStars: boolean\n}\n\nconst StyledBookContentsWrapper = styled.div<BookContentsProps>`\n  font-size: ${({ isStars }): string => (isStars ? FONT.SIZE.S : FONT.SIZE.XS)};\n  margin: ${({ isStars }): number => (isStars ? 0.4 : 0.2)}em 0;\n  opacity: 0.75;\n`\n\ninterface Props {\n  video: VideoCardType\n  featured?: boolean\n  timestamp?: string\n  big?: boolean\n}\n\nconst VideoCard: React.FC<Props> = ({ video, featured, timestamp, big }) => {\n  const featuredBookCount = (video.timestamps || []).filter(\n    (t) => t.book && t.book.id\n  ).length\n\n  return (\n    <StyledVideoCard\n      to={timestamp ? `${video.slug}?at=${timestamp}` : video.slug}\n      style={\n        {\n          background: featured && video.image.colors.lightVibrant,\n          color: featured && video.image.colors.darkMuted,\n          '--primary-color': video.image.colors.vibrant,\n        } as object\n      }\n    >\n      <StyledImg\n        fluid={\n          big\n            ? [\n                {\n                  ...video.image.childImageSharp.w200,\n                  media: `(max-width: ${BREAKPOINT.M - 1}px)`,\n                },\n                {\n                  ...video.image.childImageSharp.w350,\n                  media: `(min-width: ${BREAKPOINT.M}px)`,\n                },\n              ]\n            : video.image.childImageSharp.w200\n        }\n        backgroundColor={video.image.colors.muted}\n      />\n      <StyledDetails>\n        <div>\n          {timestamp && (\n            <StyledTimestamp>Featured at {timestamp} in</StyledTimestamp>\n          )}\n          <StyledH as=\"h2\" size=\"S\">\n            {video.title}\n          </StyledH>\n\n          <StyledBookContentsWrapper isStars={!!video.ownedBy}>\n            {video.ownedBy\n              ? video.ownedBy.frontmatter.rating7 && (\n                  <StarRating of7={video.ownedBy.frontmatter.rating7} />\n                )\n              : !timestamp &&\n                featuredBookCount > 0 && (\n                  <>\n                    Featuring {featuredBookCount} book\n                    {featuredBookCount > 1 && 's'}\n                  </>\n                )}\n          </StyledBookContentsWrapper>\n        </div>\n        <StyledMeta>\n          <StyledDatePublished>\n            {shortFormatDate(video.datePublished)}\n          </StyledDatePublished>\n          <div>{formatViewCount(video.viewCount)}</div>\n        </StyledMeta>\n      </StyledDetails>\n    </StyledVideoCard>\n  )\n}\n\nexport default VideoCard\n"],"sourceRoot":""}