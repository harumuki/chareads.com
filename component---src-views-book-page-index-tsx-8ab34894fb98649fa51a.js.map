{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es7.object.entries.js","webpack:///./src/utils/urls/affiliates.ts","webpack:///./src/views/BookPage/index.tsx","webpack:///./node_modules/core-js/modules/_object-to-array.js","webpack:///./node_modules/core-js/modules/es6.array.find.js","webpack:///./node_modules/core-js/modules/es7.object.values.js"],"names":["$export","$entries","S","entries","it","AFFILIATES","GOODREADS","AMAZON","BOOK_DEPOSITORY","AFFILIATE_ACTIONS","query","BookPage","data","bookData","timestampMentionData","featuredVideoData","book","normalizeItem","timestampMentions","normalizeArray","featuredVideos","Layout","H","as","size","decorative","title","author","style","maxWidth","margin","key","image","childImageSharp","fluid","src","StarRating","of5","rating5","of7","rating7","pageCount","shortFormatDate","dateBookPublished","tags","join","Object","map","affiliateAbbr","label","href","links","long","readDates","length","dateRated","dateReviewed","summary","html","dangerouslySetInnerHTML","__html","slug","to","mention","timestamp","formatTimestamp","timestamps","find","t","id","DESCRIPTORS","getKeys","toIObject","isEnum","f","module","exports","isEntries","O","keys","i","result","call","push","$find","forced","Array","P","F","callbackfn","this","arguments","undefined","$values","values"],"mappings":"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","file":"component---src-views-book-page-index-tsx-8ab34894fb98649fa51a.js","sourcesContent":["// https://github.com/tc39/proposal-object-values-entries\nvar $export = require('./_export');\nvar $entries = require('./_object-to-array')(true);\n\n$export($export.S, 'Object', {\n  entries: function entries(it) {\n    return $entries(it);\n  }\n});\n","import { makeIsbn10 } from 'utils/formatting/isbn'\n\nexport const AFFILIATES = {\n  GOODREADS: 'gr',\n  AMAZON: 'amzn',\n  BOOK_DEPOSITORY: 'bd',\n}\n\nexport const getLink = (isbn: number, affiliateAbbr: string): string => {\n  if (affiliateAbbr === AFFILIATES.GOODREADS)\n    return `https://www.goodreads.com/search?query=${isbn}`\n\n  if (affiliateAbbr === AFFILIATES.AMAZON)\n    return `https://www.amazon.co.uk/dp/${makeIsbn10(\n      String(isbn)\n    )}?tag=thcdex-21`\n\n  if (affiliateAbbr === AFFILIATES.BOOK_DEPOSITORY)\n    return `https://bookdepository.com/search?searchTerm=${isbn}&a_id=char`\n}\n\nexport const getShortLink = (isbn: number, affiliateAbbr: string): string =>\n  `https://cha.rs/${affiliateAbbr}/${isbn.toString(36).toUpperCase()}`\n\nexport const getAffiliateLinks = (isbn: number): object => {\n  const long = {}\n  const short = {}\n\n  Object.values(AFFILIATES).forEach((affiliate: string) => {\n    long[affiliate] = getLink(isbn, affiliate)\n    short[affiliate] = getShortLink(isbn, affiliate)\n  })\n\n  return {\n    long,\n    short,\n  }\n}\n","import React from 'react'\nimport { graphql, Link } from 'gatsby'\nimport Img from 'gatsby-image'\n\nimport { RawBook, Book } from 'types/book'\nimport { RawVideoSnapshot, VideoSnapshot } from 'types/video/snapshot'\nimport { normalizeItem, normalizeArray } from 'utils/graphql/normalize'\nimport Layout from 'Layout'\nimport H from 'components/H'\nimport StarRating from 'components/StarRating'\nimport { shortFormatDate, formatTimestamp } from 'utils/formatting/time'\nimport { AFFILIATES } from 'utils/urls/affiliates'\n\nconst AFFILIATE_ACTIONS = {\n  [AFFILIATES.GOODREADS]: 'See on Goodreads',\n  [AFFILIATES.AMAZON]: 'Buy on Amazon',\n  [AFFILIATES.BOOK_DEPOSITORY]: 'Buy on Book Depository',\n}\n\ninterface Props {\n  data: {\n    bookData: RawBook\n    timestampMentionData: {\n      edges: {\n        node: RawVideoSnapshot\n      }[]\n    }\n    featuredVideoData: {\n      edges: {\n        node: RawVideoSnapshot\n      }[]\n    }\n  }\n}\n\nconst BookPage: React.FC<Props> = ({\n  data: { bookData, timestampMentionData, featuredVideoData },\n}) => {\n  const book = normalizeItem(bookData) as Book\n  const timestampMentions = normalizeArray(\n    timestampMentionData\n  ) as VideoSnapshot[]\n  const featuredVideos = normalizeArray(featuredVideoData) as VideoSnapshot[]\n\n  return (\n    <Layout>\n      <H as=\"h2\" size=\"L\" decorative>\n        {book.title}\n      </H>\n      <H as=\"h2\" size=\"M\">\n        by {book.author}\n      </H>\n\n      <figure style={{ maxWidth: 200, margin: 0 }}>\n        <Img\n          key={book.image.childImageSharp.fluid.src}\n          fluid={book.image.childImageSharp.fluid}\n        />\n      </figure>\n\n      <StarRating of5={book.rating5} of7={book.rating7} />\n\n      <dl>\n        <dt>Page count</dt>\n        <dd>{book.pageCount}</dd>\n        <dt>Date Published</dt>\n        <dd>{shortFormatDate(book.dateBookPublished)}</dd>\n        <dt>Tags</dt>\n        <dd>{book.tags.join(', ')}</dd>\n      </dl>\n\n      <ol>\n        {Object.entries(AFFILIATE_ACTIONS).map(([affiliateAbbr, label]) => (\n          <li key={affiliateAbbr}>\n            <a href={book.links.long[affiliateAbbr]}>{label}</a>\n          </li>\n        ))}\n      </ol>\n\n      <dl>\n        <dt>Date Read</dt>\n        <dd>{shortFormatDate(book.readDates[book.readDates.length - 1][1])}</dd>\n        <dt>Date Rated</dt>\n        <dd>{shortFormatDate(book.dateRated)}</dd>\n        {book.dateReviewed && (\n          <>\n            <dt>Date Reviewed</dt>\n            <dd>{shortFormatDate(book.dateReviewed)}</dd>\n          </>\n        )}\n      </dl>\n\n      {book.summary && <p>{book.summary}</p>}\n\n      {book.html && <div dangerouslySetInnerHTML={{ __html: book.html }} />}\n\n      {featuredVideos.length > 0 && (\n        <>\n          <H as=\"h3\" size=\"M\">\n            Featured video{featuredVideos.length > 1 && 's'}\n          </H>\n          <ol>\n            {featuredVideos.map(({ title, slug, image }) => (\n              <li key={slug}>\n                <Link to={slug}>\n                  {title}\n                  <figure style={{ maxWidth: 200, margin: 0 }}>\n                    <Img\n                      key={image.childImageSharp.fluid.src}\n                      fluid={image.childImageSharp.fluid}\n                    />\n                  </figure>\n                </Link>\n              </li>\n            ))}\n          </ol>\n        </>\n      )}\n\n      {timestampMentions.length > 0 && (\n        <>\n          <H as=\"h3\" size=\"M\">\n            Mentions in {featuredVideos.length > 0 && 'other '}videos\n          </H>\n          <ol>\n            {timestampMentions.map((mention) => {\n              const timestamp = formatTimestamp(\n                mention.timestamps.find((t) => t.book && t.book.id === book.id)\n                  .t\n              )\n\n              return (\n                <li key={mention.slug}>\n                  <Link to={`${mention.slug}?at=${timestamp}`}>\n                    {mention.title} at {timestamp}\n                    <figure style={{ maxWidth: 200, margin: 0 }}>\n                      <Img\n                        key={mention.image.childImageSharp.fluid.src}\n                        fluid={mention.image.childImageSharp.fluid}\n                      />\n                    </figure>\n                  </Link>\n                </li>\n              )\n            })}\n          </ol>\n        </>\n      )}\n    </Layout>\n  )\n}\n\nexport const query = graphql`\n  query BookPage($id: String!) {\n    bookData: markdownRemark(id: { eq: $id }) {\n      ...BookFields\n    }\n    timestampMentionData: allVideos(\n      filter: { timestamps: { elemMatch: { book: { id: { eq: $id } } } } }\n    ) {\n      edges {\n        node {\n          ...VideoSnapshotFields\n        }\n      }\n    }\n    featuredVideoData: allVideos(filter: { ownedBy: { id: { eq: $id } } }) {\n      edges {\n        node {\n          ...VideoSnapshotFields\n        }\n      }\n    }\n  }\n`\n\nexport default BookPage\n","var DESCRIPTORS = require('./_descriptors');\nvar getKeys = require('./_object-keys');\nvar toIObject = require('./_to-iobject');\nvar isEnum = require('./_object-pie').f;\nmodule.exports = function (isEntries) {\n  return function (it) {\n    var O = toIObject(it);\n    var keys = getKeys(O);\n    var length = keys.length;\n    var i = 0;\n    var result = [];\n    var key;\n    while (length > i) {\n      key = keys[i++];\n      if (!DESCRIPTORS || isEnum.call(O, key)) {\n        result.push(isEntries ? [key, O[key]] : O[key]);\n      }\n    }\n    return result;\n  };\n};\n","'use strict';\n// 22.1.3.8 Array.prototype.find(predicate, thisArg = undefined)\nvar $export = require('./_export');\nvar $find = require('./_array-methods')(5);\nvar KEY = 'find';\nvar forced = true;\n// Shouldn't skip holes\nif (KEY in []) Array(1)[KEY](function () { forced = false; });\n$export($export.P + $export.F * forced, 'Array', {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\nrequire('./_add-to-unscopables')(KEY);\n","// https://github.com/tc39/proposal-object-values-entries\nvar $export = require('./_export');\nvar $values = require('./_object-to-array')(false);\n\n$export($export.S, 'Object', {\n  values: function values(it) {\n    return $values(it);\n  }\n});\n"],"sourceRoot":""}